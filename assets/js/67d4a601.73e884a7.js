"use strict";(self.webpackChunkfused_docs=self.webpackChunkfused_docs||[]).push([[9326],{6472:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>a});var i=s(4848),t=s(8453);const o={},l="Top-Level Functions",r={id:"python-sdk/top-level-functions",title:"Top-Level Functions",description:"@fused.udf",source:"@site/docs/python-sdk/top-level-functions.md",sourceDirName:"python-sdk",slug:"/python-sdk/top-level-functions",permalink:"/fused-docs/python-sdk/top-level-functions",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Python SDK",permalink:"/fused-docs/python-sdk/"},next:{title:"_public_api",permalink:"/fused-docs/reference/fused/api/_public_api"}},d={},a=[{value:"@fused.udf",id:"fusedudf",level:2},{value:"run",id:"run",level:2},{value:"@fused.cache",id:"fusedcache",level:2},{value:"load",id:"load",level:2},{value:"download",id:"download",level:2},{value:"utils",id:"utils",level:2},{value:"ingest",id:"ingest",level:2},{value:"upload",id:"upload",level:2},{value:"get",id:"get",level:2},{value:"get_udfs",id:"get_udfs",level:2},{value:"list",id:"list",level:2},{value:"get",id:"get-1",level:4},{value:"delete",id:"delete",level:2},{value:"options",id:"options",level:2},{value:"set_option",id:"set_option",level:2},{value:"sign_url",id:"sign_url",level:2},{value:"sign_url_prefix",id:"sign_url_prefix",level:2},{value:"get_chunks_metadata",id:"get_chunks_metadata",level:2},{value:"get_chunk_from_table",id:"get_chunk_from_table",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"top-level-functions",children:"Top-Level Functions"}),"\n",(0,i.jsx)(n.h2,{id:"fusedudf",children:"@fused.udf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def udf(\n    fn: Optional[Callable] = None,\n    *,\n    schema: Union[Schema, Dict, None] = None,\n    name: Optional[str] = None,\n    default_parameters: Optional[Dict[str, Any]] = None,\n    headers: Optional[Sequence[Union[str, Header]]] = None\n) -> Callable[..., GeoPandasUdfV2Callable]\n"})}),"\n",(0,i.jsx)(n.p,{children:"A decorator that transforms a function into a Fused UDF."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"schema"})," - The schema for the DataFrame returned by the UDF. The schema may be either\na string (in the form ",(0,i.jsx)(n.code,{children:'"field_name:DataType field_name2:DataType"'}),", or as JSON),\nas a Python dictionary representing the schema, or a ",(0,i.jsx)(n.code,{children:"Schema"})," model object."]}),"\n",(0,i.jsxs)(n.p,{children:["Defaults to None, in which case a schema must be evaluated by calling ",(0,i.jsx)(n.code,{children:"run_local"}),"\nfor a job to be able to write output. The return value of ",(0,i.jsx)(n.code,{children:"run_local"})," will also\nindicate how to include the schema in the decorator so ",(0,i.jsx)(n.code,{children:"run_local"})," does not need\nto be run again."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"name"})," - The name of the UDF object. Defaults to the name of the function."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"default_parameters"})," - Parameters to embed in the UDF object, separately from the arguments\nlist of the function. Defaults to None for empty parameters."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"headers"})," - A list of files to include as modules when running the UDF. For example,\nwhen specifying ",(0,i.jsx)(n.code,{children:"headers=['my_header.py']"}),", inside the UDF function it may be\nreferenced as:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"import my_header\nmy_header.my_function()\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defaults to None for no headers."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"A callable that represents the transformed UDF. This callable can be used\nwithin GeoPandas workflows to apply the defined operation on geospatial data."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"To create a simple UDF that calls a utility function to calculate the area of geometries in a GeoDataFrame:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'@fused.udf\ndef udf(bbox, table_path="s3://fused-asset/infra/building_msft_us"):\n    ...\n    gdf = table_to_tile(bbox, table=table_path)\n    return gdf\n'})}),"\n",(0,i.jsx)(n.h2,{id:"run",children:"run"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def run(email_or_udf_or_token: Union[str, None, UdfJobStepConfig,\n                                     GeoPandasUdfV2] = None,\n        udf_name: Optional[str] = None,\n        *,\n        udf: Optional[GeoPandasUdfV2] = None,\n        job_step: Optional[UdfJobStepConfig] = None,\n        token: Optional[str] = None,\n        udf_email: Optional[str] = None,\n        x: Optional[int] = None,\n        y: Optional[int] = None,\n        z: Optional[int] = None,\n        lat: Optional[float] = None,\n        lng: Optional[float] = None,\n        bbox: Union[gpd.GeoDataFrame, shapely.Geometry, None] = None,\n        sync: bool = True,\n        engine: Optional[Literal["realtime", "batch", "local"]] = None,\n        type: Optional[Literal["tile", "file"]] = None,\n        **parameters)\n'})}),"\n",(0,i.jsx)(n.p,{children:"Executes a user-defined function (UDF) with various execution and input options."}),"\n",(0,i.jsx)(n.p,{children:"This function supports executing UDFs in different environments (realtime, batch, local),\nwith different types of inputs (tile coordinates, geographical bounding boxes, etc.), and\nallows for both synchronous and asynchronous execution. It dynamically determines the execution\npath based on the provided parameters."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"email_or_udf_or_token"})," - A string that can either be an email, a UDF token, or a direct\nreference to a UDF object. It can also be a UdfJobStepConfig object for detailed\nconfiguration, or None to specify UDF details in other parameters."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"udf_name"})," - The name of the UDF to execute."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"udf"})," - A GeoPandasUdfV2 object for direct execution."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"job_step"})," - A UdfJobStepConfig object for detailed execution configuration."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"token"})," - A token representing a shared UDF."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"udf_email"})," - The email associated with the UDF.\nx, y, z: Tile coordinates for tile-based UDF execution.\nlat, lng: Latitude and longitude for location-based UDF execution."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bbox"})," - A geographical bounding box (as a GeoDataFrame or shapely Geometry) defining the area of interest."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sync"})," - If True, execute the UDF synchronously. If False, execute asynchronously."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"engine"})," - The execution engine to use ('realtime', 'batch', or 'local')."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"type"})," - The type of UDF execution ('tile' or 'file')."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"**parameters"})," - Additional parameters to pass to the UDF."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Raises"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ValueError"})," - If the UDF is not specified or is specified in more than one way."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"TypeError"})," - If the first parameter is not of an expected type."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Warning"})," - Various warnings are issued for ignored parameters based on the execution path chosen."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"The result of the UDF execution, which varies based on the UDF and execution path."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"Run a UDF saved in the Fused system:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'fused.run(udf_email="username@fused.io", udf_name="my_udf_name")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Run a UDF saved in GitHub:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'loaded_udf = fused.load("https://github.com/fusedio/udfs/tree/main/public/Building_Tile_Example")\nfused.run(udf=loaded_udf, bbox=bbox)\n'})}),"\n",(0,i.jsx)(n.p,{children:"Run a UDF saved in a local directory:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'loaded_udf = fused.load("/Users/local/dir/Building_Tile_Example")\nfused.run(udf=loaded_udf, bbox=bbox)\n'})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"This function dynamically determines the execution path and parameters based on the inputs.\nIt is designed to be flexible and support various UDF execution scenarios."}),(0,i.jsxs)(n.p,{children:["Because the output must be serializable and returned via an HTTP response, Fused validates the output of UDFs that execute remotely with the ",(0,i.jsx)(n.code,{children:"realtime"})," engine and will hold back invalid responses. This might result in perceived inconsistencies because running locally with the ",(0,i.jsx)(n.code,{children:"local"})," engine does not validate and will instead return any output."]}),(0,i.jsxs)(n.p,{children:["\u261d\ufe0f See the set of supported return object types ",(0,i.jsx)(n.a,{href:"https://docs.fused.io/basics/core-concepts/#d-return-object",children:"here"}),"."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import fused\n\n@fused.udf\ndef udf(x=1):\n    return x\nfused.run(udf, engine='local') # Returns 1\nfused.run(udf, engine='realtime') # Returns None because output is not a valid response object\n"})})]}),"\n",(0,i.jsx)(n.h2,{id:"fusedcache",children:"@fused.cache"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def cache(func: Optional[Callable[..., Any]] = None,\n          path: Optional[str],\n          reset: Optional[bool]) -> Callable[..., Any]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Decorator to cache the return value of a function."}),"\n",(0,i.jsx)(n.p,{children:"This function serves as a decorator that can be applied to any function\nto cache its return values. The cache behavior can be customized through\nkeyword arguments."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"func"})," ",(0,i.jsx)(n.em,{children:"Callable, optional"})," - The function to be decorated. If None, this\nreturns a partial decorator with the passed keyword arguments."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," ",(0,i.jsx)(n.em,{children:"string, optional"})," - Path on disk where to write the cache."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"reset"})," ",(0,i.jsx)(n.em,{children:"bool, optional"})," - Whether to reset the cache on the next call."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Callable"})," - A decorator that, when applied to a function, caches its\nreturn values according to the specified keyword arguments."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.code,{children:"@cache"})," decorator to cache the return value of a function in a custom path."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'@fused.cache(path="/tmp/custom_path/")\ndef expensive_function():\n    # Function implementation goes here\n    return result\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If the output of a cached function changes, for example if remote data is modified,\nit can be reset by running the function with the ",(0,i.jsx)(n.code,{children:"reset"})," keyword argument. Afterward,\nthe argument can be cleared."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'@fused.cache(path="/tmp/custom_path/", reset=True)\ndef expensive_function():\n    # Function implementation goes here\n    return result\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The best practice is to wrap slow-runninc code in a function with arguments that make the output unique. In this example, the ",(0,i.jsx)(n.code,{children:"bbox"}),", ",(0,i.jsx)(n.code,{children:"time_of_interest"}),", and ",(0,i.jsx)(n.code,{children:"collection"})," parameters make the data load unique across calls."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# Define cached function\n@fused.cache\ndef load_data(bbox, time_of_interest, collection):\n\n    items = catalog.search(\n        collections=[collection],\n        bbox=bbox.total_bounds,\n        datetime=time_of_interest,\n        query={\"eo:cloud_cover\": {\"lt\": 10}},\n    ).item_collection()\n\n    ds = odc.stac.load(\n        items,\n        crs=\"EPSG:3857\",\n        bands=['blue', 'red', 'green', 'nir08', 'swir16', 'swir22'],\n        resolution=resolution,\n        bbox=bbox.total_bounds,\n    ).astype(float)\n    return ds\n\n# Call the function\nds = load_data(bbox, time_of_interest, collection)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"load",children:"load"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def load(url_or_udf: Union[str, Path], *, cache_key: Any = None) -> BaseUdf\n"})}),"\n",(0,i.jsx)(n.p,{children:"Loads a UDF from various sources including GitHub URLs,\nlocal files, or directories, and a Fused platform-specific identifier."}),"\n",(0,i.jsx)(n.p,{children:"This function supports loading UDFs from a GitHub repository URL, a local file path,\na directory containing UDF definitions, or a Fused platform-specific identifier\ncomposed of an email and UDF name. It intelligently determines the source type based\non the format of the input and retrieves the UDF accordingly."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"url_or_udf"}),' - A string or Path object representing the location of the UDF. This can be\na GitHub URL starting with "',(0,i.jsx)(n.a,{href:"https://github.com",children:"https://github.com"}),'", a local file path, a directory\ncontaining one or more UDFs, or a Fused platform-specific identifier in the\nformat "email/udf_name".']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cache_key"})," - An optional key used for caching the loaded UDF. If provided, the function\nwill attempt to load the UDF from cache using this key before attempting to\nload it from the specified source. Defaults to None, indicating no caching."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"BaseUdf"})," - An instance of the loaded UDF."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Raises"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FileNotFoundError"})," - If a local file or directory path is provided but does not exist."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ValueError"})," - If the URL or Fused platform-specific identifier format is incorrect or\ncannot be parsed."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Exception"})," - For errors related to network issues, file access permissions, or other\nunforeseen errors during the loading process."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"Load a UDF from a GitHub URL:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'udf = fused.load("https://github.com/fusedio/udfs/tree/main/public/REM_with_HyRiver/")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Load a UDF from a local file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'udf = fused.load("/localpath/REM_with_HyRiver/")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Load a UDF using a Fused platform-specific identifier:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'udf = fused.load("username@fused.io/REM_with_HyRiver")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"download",children:"download"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def download(url: str, file_path: str) -> str\n"})}),"\n",(0,i.jsx)(n.p,{children:"Download a file."}),"\n",(0,i.jsx)(n.p,{children:"May be called from multiple processes with the same inputs to get the same result."}),"\n",(0,i.jsx)(n.p,{children:"Fused runs UDFs from top to bottom each time code changes. This means objects in the UDF are recreated each time, which can slow down a UDF that downloads files from a remote server."}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udca1 Downloaded files are written to a mounted volume shared across all UDFs in an organization. This means that a file downloaded by one UDF can be read by other UDFs."}),"\n",(0,i.jsx)(n.p,{children:"Fused addresses the latency of downloading files with the download utility function. It stores files in the mounted filesystem so they only download the first time."}),"\n",(0,i.jsx)(n.p,{children:"\ud83d\udca1 Because a Tile UDF runs multiple chunks in parallel, the download function sets a signal lock during the first download attempt, to ensure the download happens only once."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"url"})," - The URL to download."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_path"})," - The local path where to save the file."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"The function downloads the file only on the first execution, and returns the file path."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@fused.udf\ndef geodataframe_from_geojson():\n    import geopandas as gpd\n    url = "s3://sample_bucket/my_geojson.zip"\n    path = fused.core.download(url, "tmp/my_geojson.zip")\n    gdf = gpd.read_file(path)\n    return gdf\n'})}),"\n",(0,i.jsx)(n.h2,{id:"utils",children:"utils"}),"\n",(0,i.jsx)(n.p,{children:'A module to access utility functions located in the UDF called "common".'}),"\n",(0,i.jsxs)(n.p,{children:["They can be imported by other UDFs with ",(0,i.jsx)(n.code,{children:"common = fused.public.common"}),". They contain common operations such as:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"read_shape_zip"}),"\n",(0,i.jsx)(n.li,{children:"url_to_arr"}),"\n",(0,i.jsx)(n.li,{children:"get_collection_bbox"}),"\n",(0,i.jsx)(n.li,{children:"read_tiff_pc"}),"\n",(0,i.jsx)(n.li,{children:"table_to_tile"}),"\n",(0,i.jsx)(n.li,{children:"rasterize_geometry"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["This example shows how to access the ",(0,i.jsx)(n.code,{children:"geo_buffer"})," function from the ",(0,i.jsx)(n.code,{children:"common"})," UDF."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import fused\nimport geopandas as gpd\n\ngdf = gpd.read_file('https://www2.census.gov/geo/tiger/TIGER_RD18/STATE/11_DISTRICT_OF_COLUMBIA/11/tl_rd22_11_bg.zip')\ngdf_buffered = fused.public.common.geo_buffer(gdf, 10)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This example shows how to load a table with ",(0,i.jsx)(n.code,{children:"table_to_tile"}),", which efficiently loads a table by filtering and adjusting based on the provided bounding box (bbox) and zoom level."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'table_path = "s3://fused-asset/infra/census_bg_us"\ngdf = fused.public.common.table_to_tile(\n    bbox, table_path, use_columns=["GEOID", "geometry"], min_zoom=12\n)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This example shows how to use ",(0,i.jsx)(n.code,{children:"rasterize_geometry"})," to place an input geometry within an image array."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"geom_masks = [\n    rasterize_geometry(geom, arr.shape[-2:], transform) for geom in gdf.geometry\n]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Public UDFs are listed at ",(0,i.jsx)(n.a,{href:"https://github.com/fusedio/udfs/tree/main/public",children:"https://github.com/fusedio/udfs/tree/main/public"})]}),"\n",(0,i.jsx)(n.h2,{id:"ingest",children:"ingest"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def ingest(\n    input: Union[str, Sequence[str], Path, gpd.GeoDataFrame],\n    output: Optional[str] = None,\n    *,\n    output_metadata: Optional[str] = None,\n    schema: Optional[Schema] = None,\n    file_suffix: Optional[str] = None,\n    load_columns: Optional[Sequence[str]] = None,\n    remove_cols: Optional[Sequence[str]] = None,\n    explode_geometries: bool = False,\n    drop_out_of_bounds: Optional[bool] = None,\n    partitioning_method: Literal["area", "length", "coords", "rows"] = "rows",\n    partitioning_maximum_per_file: Union[int, float, None] = None,\n    partitioning_maximum_per_chunk: Union[int, float, None] = None,\n    partitioning_max_width_ratio: Union[int, float] = 2,\n    partitioning_max_height_ratio: Union[int, float] = 2,\n    partitioning_force_utm: Literal["file", "chunk", None] = "chunk",\n    partitioning_split_method: Literal["mean", "median"] = "mean",\n    subdivide_method: Literal["area", None] = None,\n    subdivide_start: Optional[float] = None,\n    subdivide_stop: Optional[float] = None,\n    split_identical_centroids: bool = True,\n    target_num_chunks: int = 5000,\n    lonlat_cols: Optional[Tuple[str, str]] = None,\n    gdal_config: Union[GDALOpenConfig, Dict[str, Any], None] = None\n) -> GeospatialPartitionJobStepConfig\n'})}),"\n",(0,i.jsx)(n.p,{children:"Ingest a dataset into the Fused partitioned format."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"input"})," - A GeoPandas ",(0,i.jsx)(n.code,{children:"GeoDataFrame"})," or a path to file or files on S3 to ingest. Files may be Parquet or another geo data format."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"output"})," - Location on S3 to write the ",(0,i.jsx)(n.code,{children:"main"})," table to."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"output_metadata"})," - Location on S3 to write the ",(0,i.jsx)(n.code,{children:"fused"})," table to."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"schema"})," - Schema of the data to be ingested. This is optional and will be inferred from the data if not provided."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"file_suffix"})," - filter which files are used for ingestion. If ",(0,i.jsx)(n.code,{children:"input"})," is a directory on S3, all files under that directory will be listed and used for ingestion. If ",(0,i.jsx)(n.code,{children:"file_suffix"})," is not None, it will be used to filter paths by checking the trailing characters of each filename. E.g. pass ",(0,i.jsx)(n.code,{children:'file_suffix=".geojson"'})," to include only GeoJSON files inside the directory."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"load_columns"})," - Read only this set of columns when ingesting geospatial datasets. Defaults to all columns."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"remove_cols"})," - The named columns to drop when ingesting geospatial datasets. Defaults to not drop any columns."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"explode_geometries"})," - Whether to unpack multipart geometries to single geometries when ingesting geospatial datasets, saving each part as its own row. Defaults to ",(0,i.jsx)(n.code,{children:"False"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"drop_out_of_bounds"})," - Whether to drop geometries outside of the expected WGS84 bounds. Defaults to True."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_method"})," - The method to use for grouping rows into partitions. Defaults to ",(0,i.jsx)(n.code,{children:'"rows"'}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"area"'}),": Construct partitions where all contain a maximum total area among geometries."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"length"'}),": Construct partitions where all contain a maximum total length among geometries."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"coords"'}),": Construct partitions where all contain a maximum total number of coordinates among geometries."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"rows"'}),": Construct partitions where all contain a maximum number of rows."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_maximum_per_file"})," - Maximum value for ",(0,i.jsx)(n.code,{children:"partitioning_method"})," to use per file. If ",(0,i.jsx)(n.code,{children:"None"}),", defaults to ",(0,i.jsx)(n.em,{children:"1/10th"})," of the total value of ",(0,i.jsx)(n.code,{children:"partitioning_method"}),". So if the value is ",(0,i.jsx)(n.code,{children:"None"})," and ",(0,i.jsx)(n.code,{children:"partitioning_method"})," is ",(0,i.jsx)(n.code,{children:'"area"'}),", then each file will be have no more than 1/10th the total area of all geometries. Defaults to ",(0,i.jsx)(n.code,{children:"None"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_maximum_per_chunk"})," - Maximum value for ",(0,i.jsx)(n.code,{children:"partitioning_method"})," to use per chunk. If ",(0,i.jsx)(n.code,{children:"None"}),", defaults to ",(0,i.jsx)(n.em,{children:"1/100th"})," of the total value of ",(0,i.jsx)(n.code,{children:"partitioning_method"}),". So if the value is ",(0,i.jsx)(n.code,{children:"None"})," and ",(0,i.jsx)(n.code,{children:"partitioning_method"})," is ",(0,i.jsx)(n.code,{children:'"area"'}),", then each file will be have no more than 1/100th the total area of all geometries. Defaults to ",(0,i.jsx)(n.code,{children:"None"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_max_width_ratio"})," - The maximum ratio of width to height of each partition to use in the ingestion process. So for example, if the value is ",(0,i.jsx)(n.code,{children:"2"}),", then if the width divided by the height is greater than ",(0,i.jsx)(n.code,{children:"2"}),", the box will be split in half along the horizontal axis. Defaults to ",(0,i.jsx)(n.code,{children:"2"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_max_height_ratio"})," - The maximum ratio of height to width of each partition to use in the ingestion process. So for example, if the value is ",(0,i.jsx)(n.code,{children:"2"}),", then if the height divided by the width is greater than ",(0,i.jsx)(n.code,{children:"2"}),", the box will be split in half along the vertical axis. Defaults to ",(0,i.jsx)(n.code,{children:"2"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_force_utm"})," - Whether to force partitioning within UTM zones. If set to ",(0,i.jsx)(n.code,{children:'"file"'}),", this will ensure that the centroid of all geometries per ",(0,i.jsx)(n.em,{children:"file"})," are contained in the same UTM zone. If set to ",(0,i.jsx)(n.code,{children:'"chunk"'}),", this will ensure that the centroid of all geometries per ",(0,i.jsx)(n.em,{children:"chunk"})," are contained in the same UTM zone. If set to ",(0,i.jsx)(n.code,{children:"None"}),', then no UTM-based partitioning will be done. Defaults to "chunk".']}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"partitioning_split_method"})," - How to split one partition into children. Defaults to ",(0,i.jsx)(n.code,{children:'"mean"'})," (this may change in the future)."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"mean"'}),": Split each axis according to the mean of the centroid values."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"median"'}),": Split each axis according to the median of the centroid values."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"subdivide_method"})," - The method to use for subdividing large geometries into multiple rows. Currently the only option is ",(0,i.jsx)(n.code,{children:'"area"'}),", where geometries will be subdivided based on their area (in WGS84 degrees)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"subdivide_start"})," - The value above which geometries will be subdivided into smaller parts, according to ",(0,i.jsx)(n.code,{children:"subdivide_method"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"subdivide_stop"})," - The value below which geometries will never be subdivided into smaller parts, according to ",(0,i.jsx)(n.code,{children:"subdivide_method"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"split_identical_centroids"})," - If ",(0,i.jsx)(n.code,{children:"True"}),', should split a partition that has\nidentical centroids (such as if all geometries in the partition are the\nsame) if there are more such rows than defined in "partitioning_maximum_per_file" and\n"partitioning_maximum_per_chunk".']}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"target_num_chunks"})," - The target for the number of chunks if ",(0,i.jsx)(n.code,{children:"partitioning_maximum_per_file"})," is None. Note that this number is only a ",(0,i.jsx)(n.em,{children:"target"})," and the actual number of files and chunks generated can be higher or lower than this number, depending on the spatial distribution of the data itself."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"lonlat_cols"})," - Names of longitude, latitude columns to construct point geometries from."]}),"\n",(0,i.jsxs)(n.p,{children:["If your point columns are named ",(0,i.jsx)(n.code,{children:'"x"'})," and ",(0,i.jsx)(n.code,{children:'"y"'}),", then pass:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'fused.ingest(\n    ...,\n    lonlat_cols=("x", "y")\n)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This only applies to reading from Parquet files. For reading from CSV files, pass options to ",(0,i.jsx)(n.code,{children:"gdal_config"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"gdal_config"})," - Configuration options to pass to GDAL for how to read these files. For all files other than Parquet files, Fused uses GDAL as a step in the ingestion process. For some inputs, like CSV files or zipped shapefiles, you may need to pass some parameters to GDAL to tell it how to open your files."]}),"\n",(0,i.jsx)(n.p,{children:"This config is expected to be a dictionary with up to two keys:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"layer"}),": ",(0,i.jsx)(n.code,{children:"str"}),". Define the layer of the input file you wish to read when the source contains multiple layers, as in GeoPackage."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"open_options"}),": ",(0,i.jsx)(n.code,{children:"Dict[str, str]"}),". Pass in key-value pairs with GDAL open options. These are defined on each driver's page in the GDAL documentation. For example, the ",(0,i.jsx)(n.a,{href:"https://gdal.org/drivers/vector/csv.html",children:"CSV driver"})," defines ",(0,i.jsx)(n.a,{href:"https://gdal.org/drivers/vector/csv.html#open-options",children:"these open options"})," you can pass in."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For example, if you're ingesting a CSV file with two columns\n",(0,i.jsx)(n.code,{children:'"longitude"'})," and ",(0,i.jsx)(n.code,{children:'"latitude"'})," denoting the coordinate information, pass"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'fused.ingest(\n    ...,\n    gdal_config={\n        "open_options": {\n            "X_POSSIBLE_NAMES": "longitude",\n            "Y_POSSIBLE_NAMES": "latitude",\n        }\n    }\n)\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Configuration object describing the ingestion process. Call ",(0,i.jsx)(n.code,{children:".run_remote"})," on this object to start a job."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'job = fused.ingest(\n    input="https://www2.census.gov/geo/tiger/TIGER_RD18/STATE/06_CALIFORNIA/06/tl_rd22_06_bg.zip",\n    output="s3://fused-sample/census/ca_bg_2022/main/",\n    output_metadata="s3://fused-sample/census/ca_bg_2022/fused/",\n    explode_geometries=True,\n    partitioning_maximum_per_file=2000,\n    partitioning_maximum_per_chunk=200,\n).run_remote()\n'})}),"\n",(0,i.jsx)(n.h2,{id:"upload",children:"upload"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def upload(local_path: Union[str, Path, bytes, BinaryIO],\n           remote_path: str) -> None\n"})}),"\n",(0,i.jsx)(n.p,{children:"Upload local file to S3."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"local_path"})," - Either a path to a local file (",(0,i.jsx)(n.code,{children:"str"}),", ",(0,i.jsx)(n.code,{children:"Path"}),") or the contents to upload.\nAny string will be treated as a Path, if you wish to upload the contents of\nthe string, first encode it: ",(0,i.jsx)(n.code,{children:'s.encode("utf-8")'})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"remote_path"})," - URL to upload to, like ",(0,i.jsx)(n.code,{children:"fd://new-file.txt"})]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["Fused holds files in memory during the upload process, so it's best to keep file sizes ",(0,i.jsx)(n.code,{children:"< 300 MB"}),". It's possible larger files cause errors. To upload a large file, it's best to partition the file into smaller files and upload each one individually."]})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"To upload a local json file to your Fused-managed S3 bucket:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'fused.upload("my_file.json", "fd://my_bucket/my_file.json")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"get",children:"get"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get(path: str) -> bytes\n"})}),"\n",(0,i.jsx)(n.p,{children:"Download the contents at the path to memory."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," - URL to a file, like ",(0,i.jsx)(n.code,{children:"fd://bucket-name/file.parquet"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"bytes of the file"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'fused.get("fd://bucket-name/file.parquet")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"get_udfs",children:"get_udfs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def get_udfs(n: int = 10,\n             *,\n             skip: int = 0,\n             per_request: int = 25,\n             max_requests: Optional[int] = None,\n             by: Literal["name", "id", "slug"] = "name",\n             whose: Literal["self", "public"] = "self")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Fetches a list of UDFs."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"n"})," - The total number of UDFs to fetch. Defaults to 10."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"skip"})," - The number of UDFs to skip before starting to collect the result set. Defaults to 0."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"per_request"})," - The number of UDFs to fetch in each API request. Defaults to 25."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"max_requests"})," - The maximum number of API requests to make."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"by"}),' - The attribute by which to sort the UDFs. Can be "name", "id", or "slug". Defaults to "name".']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"whose"}),' - Specifies whose UDFs to fetch. Can be "self" for the user\'s own UDFs or "public" for\nUDFs available publicly. Defaults to "self".']}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"A list of UDFs."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"Fetch UDFs under the user account:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"fused.get_udfs()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"list",children:"list"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," - Parent directory, like ",(0,i.jsx)(n.code,{children:"table_name"}),". Defaults to None to list the root of the project."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"A list of paths as URLs"}),"\n",(0,i.jsx)(n.h4,{id:"get-1",children:"get"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get(path: str) -> bytes\n"})}),"\n",(0,i.jsx)(n.p,{children:"Download the contents at the path to memory."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," - Path to a file, like ",(0,i.jsx)(n.code,{children:"table_name/file.parquet"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"bytes of the file"}),"\n",(0,i.jsx)(n.h2,{id:"delete",children:"delete"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def delete(path: str,\n           max_deletion_depth: Union[int, Literal["unlimited"]] = 2) -> bool\n'})}),"\n",(0,i.jsx)(n.p,{children:"Delete the files at the path."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"path"})," - Directory or file to delete, like ",(0,i.jsx)(n.code,{children:"fd://my-old-table/"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"max_deletion_depth"})," - If set (defaults to 2), the maximum depth the operation will recurse to.\nThis option is to help avoid accidentally deleting more data that intended.\nPass ",(0,i.jsx)(n.code,{children:'"unlimited"'})," for unlimited."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'fused.delete("fd://bucket-name/deprecated_table/")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"options",children:"options"}),"\n",(0,i.jsx)(n.p,{children:"List global configuration options."}),"\n",(0,i.jsx)(n.p,{children:"This object contains a set of configuration options that control global behavior of the library. This object can be used to modify the options."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Change the ",(0,i.jsx)(n.code,{children:"request_timeout"})," option from its default value to 120 seconds:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"fused.options.request_timeout = 120\n"})}),"\n",(0,i.jsx)(n.h2,{id:"set_option",children:"set_option"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def set_option(option_name: str, option_value: Any)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Sets the value of a configuration option."}),"\n",(0,i.jsxs)(n.p,{children:["This function updates the global ",(0,i.jsx)(n.code,{children:"options"})," object with a new value for a specified option.\nIt supports setting values for nested options using dot notation. For example, if the\n",(0,i.jsx)(n.code,{children:"options"}),' object has a nested structure, you can set a value for a nested attribute\nby specifying the option name in the form "parent.child".']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"option_name"})," - A string specifying the name of the option to set. This can be a simple\nattribute name or a dot-separated path for nested attributes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"option_value"})," - The new value to set for the specified option. This can be of any type\nthat is compatible with the attribute being set."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Raises"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AttributeError"})," - If the specified attribute path is not valid, either because a part\nof the path does not exist or the final attribute cannot be set with\nthe provided value."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["Set the ",(0,i.jsx)(n.code,{children:"request_timeout"})," top-level option to 120 seconds:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"set_option('request_timeout', 120)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"sign_url",children:"sign_url"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def sign_url(path: str) -> str\n"})}),"\n",(0,i.jsx)(n.p,{children:"Create a signed URL to access the path."}),"\n",(0,i.jsx)(n.p,{children:"This function may not check that the file represented by the path exists."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," - URL to a file, like ",(0,i.jsx)(n.code,{children:"fd://bucket-name/file.parquet"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"HTTPS URL to access the file using signed access."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'fused.sign_url("fd://bucket-name/table_directory/file.parquet")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"sign_url_prefix",children:"sign_url_prefix"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def sign_url_prefix(path: str) -> Dict[str, str]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Create signed URLs to access all blobs under the path."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"})," - URL to a prefix, like ",(0,i.jsx)(n.code,{children:"fd://bucket-name/some_directory/"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns"}),":"]}),"\n",(0,i.jsx)(n.p,{children:"Dictionary mapping from blob store key to signed HTTPS URL."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'fused.sign_url_prefix("fd://bucket-name/table_directory/")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"get_chunks_metadata",children:"get_chunks_metadata"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get_chunks_metadata(url: str) -> gpd.GeoDataFrame\n"})}),"\n",(0,i.jsx)(n.p,{children:"Returns a GeoDataFrame with each chunk in the table as a row."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"url"})," - URL of the table."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"get_chunk_from_table",children:"get_chunk_from_table"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def get_chunk_from_table(\n        url: str,\n        file_id: Union[str, int, None],\n        chunk_id: Optional[int],\n        *,\n        columns: Optional[Iterable[str]] = None) -> gpd.GeoDataFrame\n"})}),"\n",(0,i.jsx)(n.p,{children:"Returns a chunk from a table and chunk coordinates."}),"\n",(0,i.jsxs)(n.p,{children:["This can be called with file_id and chunk_id from ",(0,i.jsx)(n.code,{children:"get_chunks_metadata"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Arguments"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"url"})," - URL of the table."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"file_id"})," - File ID to read."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"chunk_id"})," - Chunk ID to read."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"columns"})," - Read only the specified columns."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var i=s(6540);const t={},o=i.createContext(t);function l(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);