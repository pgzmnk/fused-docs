"use strict";(self.webpackChunkfused_docs=self.webpackChunkfused_docs||[]).push([[8642],{4379:(t,e,l)=>{l.r(e),l.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>x});var n=l(4848),s=l(8453),d=l(8987),i=(l(1023),l(290),l(6012));const r={title:"DuckDB",sidebar_label:"DuckDB",path:"basics/in/duckdb/duckdb",nb_path:"basics/in/duckdb.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb",description:"Load DuckDB data with Fused!"},c="DuckDB",o={id:"basics/in/duckdb/Duckdb",title:"DuckDB",description:"Load DuckDB data with Fused!",source:"@site/docs/basics/in/duckdb/Duckdb.mdx",sourceDirName:"basics/in/duckdb",slug:"/basics/in/duckdb/",permalink:"/fused-docs/basics/in/duckdb/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"DuckDB",sidebar_label:"DuckDB",path:"basics/in/duckdb/duckdb",nb_path:"basics/in/duckdb.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb",description:"Load DuckDB data with Fused!"},sidebar:"tutorialSidebar",previous:{title:"Draw (with Leaflet)",permalink:"/fused-docs/basics/in/draw/"},next:{title:"Excel",permalink:"/fused-docs/basics/in/excel/"}},a={},x=[];function u(t){const e={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...t.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.A,{githubUrl:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb",colabUrl:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/duckdb.ipynb"}),"\n",(0,n.jsx)(e.h1,{id:"duckdb",children:"DuckDB"}),"\n","\n","\n",(0,n.jsxs)(e.p,{children:["Fused interfaces ",(0,n.jsx)(i.A,{color:"#3399ff",children:"DuckDB"})," through the Python ",(0,n.jsx)(e.code,{children:"duckdb"})," library.\nThis example shows how to load data from ",(0,n.jsx)(e.a,{href:"https://duckdb.org/",children:"DuckDB"})," into your Fused\nUDFs."]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"# !pip install fused duckdb -q\n"})}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:'# Note: This UDF is only for demo purposes. You may get `HTTP GET error` after several times calling it. This is the data retrieval issue caused by Cloudfront servers not responding.\n\nimport fused\n\n\n@fused.udf\ndef udf(bbox=None, agg_factor=3, min_count=5):\n    import duckdb\n\n    utils = fused.load(\n        "https://github.com/fusedio/udfs/tree/f928ee1/public/common/"\n    ).utils\n    con = duckdb.connect()\n\n    print("duckdb version:", duckdb.__version__)\n    con.sql(\n        """SET home_directory=\'/tmp/\';\n    install \'httpfs\';\n    load \'httpfs\';\n    """\n    )\n    df = con.sql(\n        f"""\n    SELECT round(pickup_longitude*{agg_factor},3)/{agg_factor} lng, \n           round(pickup_latitude*{agg_factor},3)/{agg_factor} lat, \n           count(1) cnt\n    FROM read_parquet(\'https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2010-01.parquet\') \n    GROUP BY round(pickup_longitude*{agg_factor},3), \n             round(pickup_latitude*{agg_factor},3)\n    HAVING cnt>{min_count} and lat>40 and lat<41\n    """\n    ).df()\n    print("number of trips:", df.cnt.sum())\n    gdf = utils.geo_convert(df)\n    return gdf\n\n\ngdf = fused.run(udf=udf)\ngdf\n'})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{style:{textAlign:"left"}}),(0,n.jsx)(e.th,{style:{textAlign:"left"},children:"lng"}),(0,n.jsx)(e.th,{style:{textAlign:"left"},children:"lat"}),(0,n.jsx)(e.th,{style:{textAlign:"left"},children:"cnt"}),(0,n.jsx)(e.th,{style:{textAlign:"left"},children:"geometry"}),(0,n.jsx)(e.th,{style:{textAlign:"left"},children:"fused_index"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"0"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.956667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.767667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"196"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.95667 40.76767)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"0"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"1"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.996000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.764000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"1288"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.99600 40.76400)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"1"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"2"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.990000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.725667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"1780"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.99000 40.72567)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"2"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"3"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.997000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.716667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"648"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.99700 40.71667)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"3"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"4"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.991667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.729667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"2953"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.99167 40.72967)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"4"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"..."})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44847"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.935333"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.757333"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"6"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.93533 40.75733)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44847"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44848"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.929667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.765000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"7"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.92967 40.76500)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44848"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44849"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-74.009667"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.730000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"6"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-74.00967 40.73000)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44849"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44850"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.864333"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.767000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"6"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.86433 40.76700)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44850"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44851"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"-73.926333"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"40.866000"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"6"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"POINT (-73.92633 40.86600)"}),(0,n.jsx)(e.td,{style:{textAlign:"left"},children:"44851"})]})]})]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python"})})]})}function h(t={}){const{wrapper:e}={...(0,s.R)(),...t.components};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(u,{...t})}):u(t)}},1023:(t,e,l)=>{l.d(e,{A:()=>h});l(6540);var n,s=new Uint8Array(16);function d(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)}const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=function(t){return"string"==typeof t&&i.test(t)};for(var c=[],o=0;o<256;++o)c.push((o+256).toString(16).substr(1));const a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!r(l))throw TypeError("Stringified UUID is invalid");return l};const x=function(t,e,l){var n=(t=t||{}).random||(t.rng||d)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){l=l||0;for(var s=0;s<16;++s)e[l+s]=n[s];return e}return a(n)};var u=l(4848);const h=t=>(0,u.jsxs)("div",{style:{backgroundColor:"var(--ifm-background-surface-color)",marginBottom:"var(--ifm-leading)",borderRadius:"var(--ifm-global-radius)",boxShadow:"var(--ifm-global-shadow-lw)",overflow:"hidden",padding:"10px",font:"var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"},children:[(0,u.jsx)("span",{style:{color:"var(--ifm-color-primary)"},children:"Out: "}),(0,u.jsx)("pre",{style:{margin:"0px",backgroundColor:"inherit"},children:t.children.split("\n").map((t=>(0,u.jsx)("p",{style:{marginBottom:"0px"},children:t},x())))})]})},8987:(t,e,l)=>{l.d(e,{A:()=>d});l(6540);var n=l(8774),s=l(4848);const d=t=>{let{githubUrl:e,colabUrl:l}=t;return(0,s.jsxs)("div",{className:"link-buttons",style:{textAlign:"right"},children:[(0,s.jsx)("br",{}),(0,s.jsx)(n.A,{to:l,children:(0,s.jsx)("img",{src:"https://colab.research.google.com/assets/colab-badge.svg",alt:"Open in Colab"})})," ",(0,s.jsx)(n.A,{to:e,children:(0,s.jsx)("img",{src:"https://badgen.net/static/GitHub/Open/blue?icon=github",alt:"Open in GitHub"})})]})}},290:(t,e,l)=>{l(6540);var n=l(3259),s=l.n(n),d=(l(2303),l(4848));s()({loader:()=>l.e(1236).then(l.bind(l,1236)),loading:t=>{let{timedOut:e}=t;return e?(0,d.jsx)("blockquote",{children:"Error: Loading Plotly timed out."}):(0,d.jsx)("div",{children:"loading..."})},timeout:1e4})},6012:(t,e,l)=>{l.d(e,{A:()=>s});l(6540);var n=l(4848);function s(t){let{children:e,color:l}=t;return(0,n.jsx)("span",{style:{backgroundColor:l,borderRadius:"4px",color:"#fff",padding:"0.2rem 0.5rem",fontWeight:"bold"},children:e})}},8453:(t,e,l)=>{l.d(e,{R:()=>i,x:()=>r});var n=l(6540);const s={},d=n.createContext(s);function i(t){const e=n.useContext(d);return n.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function r(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(s):t.components||s:i(t.components),n.createElement(d.Provider,{value:e},t.children)}}}]);