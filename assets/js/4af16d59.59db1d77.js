"use strict";(self.webpackChunkfused_docs=self.webpackChunkfused_docs||[]).push([[4429],{2795:(t,e,l)=>{l.r(e),l.d(e,{assets:()=>h,contentTitle:()=>r,default:()=>o,frontMatter:()=>d,metadata:()=>c,toc:()=>x});var s=l(4848),i=l(8453),n=l(8987);l(1023),l(290);const d={title:"CSV",sidebar_label:"CSV",path:"basics/in/csv/csv",nb_path:"basics/in/csv.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb",description:"Load CSV data with Fused!"},r="CSV Files",c={id:"basics/in/csv/Csv",title:"CSV",description:"Load CSV data with Fused!",source:"@site/docs/basics/in/csv/Csv.mdx",sourceDirName:"basics/in/csv",slug:"/basics/in/csv/",permalink:"/fused-docs/basics/in/csv/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"CSV",sidebar_label:"CSV",path:"basics/in/csv/csv",nb_path:"basics/in/csv.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb",description:"Load CSV data with Fused!"},sidebar:"tutorialSidebar",previous:{title:"BigQuery",permalink:"/fused-docs/basics/in/bigquery/"},next:{title:"Draw (with Leaflet)",permalink:"/fused-docs/basics/in/draw/"}},h={},x=[{value:"CSV",id:"csv",level:2},{value:"TSV",id:"tsv",level:2}];function a(t){const e={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...t.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{githubUrl:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb",colabUrl:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/in/csv.ipynb"}),"\n",(0,s.jsx)(e.h1,{id:"csv-files",children:"CSV Files"}),"\n",(0,s.jsx)(e.p,{children:"Use pandas to read CSV files."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"#!pip install fused pandas\n"})}),"\n",(0,s.jsx)(e.h2,{id:"csv",children:"CSV"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'import fused\n\n\n@fused.udf\ndef udf():\n\n    import pandas as pd\n\n    # Read csv file\n    # https://catalog.data.gov/dataset/supply-chain-greenhouse-gas-emission-factors-v1-2-by-naics-6\n    df = pd.read_csv(\n        "https://pasteur.epa.gov/uploads/10.23719/1528686/SupplyChainGHGEmissionFactors_v1.2_NAICS_CO2e_USD2021.csv"\n    )\n\n    return df\n\n\ndf = fused.run(udf=udf, engine="local")\ndf.head()\n'})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{style:{textAlign:"right"}}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"2017 NAICS Code"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"2017 NAICS Title"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"GHG"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Unit"}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"Supply Chain Emission Factors without Margins"}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"Margins of Supply Chain Emission Factors"}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"Supply Chain Emission Factors with Margins"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Reference USEEIO Code"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"111110"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Soybean Farming"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"All GHGs"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"kg CO2e/2021 USD, purchaser price"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1.223"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0.103"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1.326"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"1111A0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"111120"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Oilseed (except Soybean) Farming"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"All GHGs"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"kg CO2e/2021 USD, purchaser price"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1.223"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0.103"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1.326"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"1111A0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"111130"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Dry Pea and Bean Farming"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"All GHGs"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"kg CO2e/2021 USD, purchaser price"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2.874"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0.134"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3.007"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"1111B0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"111140"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Wheat Farming"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"All GHGs"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"kg CO2e/2021 USD, purchaser price"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2.874"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0.134"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3.007"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"1111B0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"4"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"111150"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Corn Farming"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"All GHGs"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"kg CO2e/2021 USD, purchaser price"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2.874"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0.134"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3.007"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"1111B0"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"tsv",children:"TSV"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'import fused\n\n\n@fused.udf\ndef udf():\n\n    import pandas as pd\n\n    # Read census .txt file as csv\n    df = pd.read_csv(\n        "https://www2.census.gov/programs-surveys/acs/summary_file/2022/table-based-SF/documentation/ACS20225YR_Table_Shells.txt",\n        delimiter="|",\n    )\n\n    return df\n\n\ndf = fused.run(udf=udf, engine="local")\ndf.head()\n'})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{style:{textAlign:"right"}}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Table ID"}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"Line"}),(0,s.jsx)(e.th,{style:{textAlign:"right"},children:"Indent"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Unique ID"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Label"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Title"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Universe"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Type"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"0"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001_001"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total:"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Sex by Age"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total population"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"int"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"1"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001_002"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Male:"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Sex by Age"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total population"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"int"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001_003"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Under 5 years"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Sex by Age"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total population"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"int"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"3"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"4"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001_004"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"5 to 9 years"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Sex by Age"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total population"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"int"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"4"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"5"}),(0,s.jsx)(e.td,{style:{textAlign:"right"},children:"2"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"B01001_005"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"10 to 14 years"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Sex by Age"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Total population"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"int"})]})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python"})})]})}function o(t={}){const{wrapper:e}={...(0,i.R)(),...t.components};return e?(0,s.jsx)(e,{...t,children:(0,s.jsx)(a,{...t})}):a(t)}},1023:(t,e,l)=>{l.d(e,{A:()=>g});l(6540);var s,i=new Uint8Array(16);function n(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(i)}const d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=function(t){return"string"==typeof t&&d.test(t)};for(var c=[],h=0;h<256;++h)c.push((h+256).toString(16).substr(1));const x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!r(l))throw TypeError("Stringified UUID is invalid");return l};const a=function(t,e,l){var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){l=l||0;for(var i=0;i<16;++i)e[l+i]=s[i];return e}return x(s)};var o=l(4848);const g=t=>(0,o.jsxs)("div",{style:{backgroundColor:"var(--ifm-background-surface-color)",marginBottom:"var(--ifm-leading)",borderRadius:"var(--ifm-global-radius)",boxShadow:"var(--ifm-global-shadow-lw)",overflow:"hidden",padding:"10px",font:"var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"},children:[(0,o.jsx)("span",{style:{color:"var(--ifm-color-primary)"},children:"Out: "}),(0,o.jsx)("pre",{style:{margin:"0px",backgroundColor:"inherit"},children:t.children.split("\n").map((t=>(0,o.jsx)("p",{style:{marginBottom:"0px"},children:t},a())))})]})},8987:(t,e,l)=>{l.d(e,{A:()=>n});l(6540);var s=l(8774),i=l(4848);const n=t=>{let{githubUrl:e,colabUrl:l}=t;return(0,i.jsxs)("div",{className:"link-buttons",style:{textAlign:"right"},children:[(0,i.jsx)("br",{}),(0,i.jsx)(s.A,{to:l,children:(0,i.jsx)("img",{src:"https://colab.research.google.com/assets/colab-badge.svg",alt:"Open in Colab"})})," ",(0,i.jsx)(s.A,{to:e,children:(0,i.jsx)("img",{src:"https://badgen.net/static/GitHub/Open/blue?icon=github",alt:"Open in GitHub"})})]})}},290:(t,e,l)=>{l(6540);var s=l(3259),i=l.n(s),n=(l(2303),l(4848));i()({loader:()=>l.e(1236).then(l.bind(l,1236)),loading:t=>{let{timedOut:e}=t;return e?(0,n.jsx)("blockquote",{children:"Error: Loading Plotly timed out."}):(0,n.jsx)("div",{children:"loading..."})},timeout:1e4})},8453:(t,e,l)=>{l.d(e,{R:()=>d,x:()=>r});var s=l(6540);const i={},n=s.createContext(i);function d(t){const e=s.useContext(n);return s.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function r(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(i):t.components||i:d(t.components),s.createElement(n.Provider,{value:e},t.children)}}}]);