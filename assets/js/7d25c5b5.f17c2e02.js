"use strict";(self.webpackChunkfused_docs=self.webpackChunkfused_docs||[]).push([[6970],{7649:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>f,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var s=n(4848),o=n(8453),i=n(3650);const r={},l="Raster with polygon (Zonal stats)",a={id:"basics/transform/join/raster-with-polygon",title:"Raster with polygon (Zonal stats)",description:"",source:"@site/docs/basics/transform/join/raster-with-polygon.mdx",sourceDirName:"basics/transform/join",slug:"/basics/transform/join/raster-with-polygon",permalink:"/fused-docs/basics/transform/join/raster-with-polygon",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Point with polygon",permalink:"/fused-docs/basics/transform/join/point-with-polygon"},next:{title:"Band algebra",permalink:"/fused-docs/basics/transform/raster/band-algebra"}},d={},c=[];function u(e){const t={code:"code",h1:"h1",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"raster-with-polygon-zonal-stats",children:"Raster with polygon (Zonal stats)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'@fused.udf\ndef udf(\n    bbox: fused.types.TileGDF, min_zoom=12, table="s3://fused-asset/infra/building_msft_us/", chip_len=256\n):\n    utils = fused.load("https://github.com/fusedio/udfs/tree/f928ee1/public/common/").utils\n   \n    # Conditionally run the UDF if zoom level is high enough, to avoid blowing up the memory\n    if bbox.z[0] >= min_zoom:\n\n        # Load GeoDataFrame (Vector)\n        gdf = utils.table_to_tile(bbox, table, min_zoom)\n\n        # Load DSM array (Raster)\n        dsm_to_tile = fused.load("https://github.com/fusedio/udfs/tree/f928ee1/public/DSM_JAXA_Example").utils.dsm_to_tile\n        arr = dsm_to_tile(bbox, z_levels=[4, 6, 9, 11], verbose=False)\n\n        # Run zonal statistics\n        return utils.geom_stats(gdf, arr, chip_len=chip_len)\n    else:\n        print("Please zoom more... (US Only)")\n'})}),"\n","\n","\n",(0,s.jsx)(i.A,{url:"https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA31T227bMAz9FcMD1hVIfMmlsQMYe9ge97ZiL3VhKBLtaJElTaKTukH%2BfXSSrlnQlpJh8hxSpChpH3IjIFyGsrXGYWB7AXwTMB9YsSn1GfXogLVK4kB4LPUwPgXfCEUIWmZL7TE6xVZ8zRx%2BKXVAQotE3wk8m4OQd%2BWxV1CUIekr87SM4yPg45MdC%2BY2421ehqPXMKklSqaqrYQdxVPeYlj8F5k%2FB%2BsiwyCKocROQDFdRItsOpmOrnijm5PDOJ1Motl0Ms%2BvXJ6NaYt0foVaiXxdJBfo7YWuWA%2FOFw9XMVToj4G5KnKQMryXCo7sf%2Ft9EcGQUafWiNYfG8UaqZuo7jyISJrYg9uCi7dpTIehULYw9nQAIOLVKs0W%2FG4ukqSuRUKj5iyBJE2S7C7POc8SkedslbHZKp%2BlaT2bp%2FMZeU0X%2BfQuq2PX6RjlcC7750O8f6KvP3wV2FuoTIeVYx7BFVY3n1%2FBLXA0rmjA%2FPZGv7klK%2FmGregC3LsO3uBrqRSI91i6i2bzPt0AVkpqqLhRVMfNg3XGgkMJPhqujR8FCc3Hm3dih%2BQfxF4g3HQaP1rqWMZOClwXkyuX21fz8UwRRDMchQ7%2BdNJBCxp9uHwIqZWWacH8mQOPg%2FrEnGM9KT1zin6n13dUamV2x1dIVuOYXW%2FlM6n%2FXvGYcQgfD38BVPr89%2FwDAAA%3D"})]})}function f(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},3650:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(6540),o=n(4848);function i(e){let{id:t,url:n}=e;const i=(0,s.useRef)(null);return(0,s.useEffect)((()=>{let e=null;document.getElementById("magic-iframe-"+t)?e=document.getElementById("magic-iframe-"+t):(e=document.createElement("iframe"),e.src=n,e.height="1050px",e.width="100%",e.scrolling="no",e.id="magic-iframe-"+t,document.body.appendChild(e));const s=i.current.getBoundingClientRect();return e.style.position="absolute",e.style.left=`${s.left+window.scrollX}px`,e.style.top=`${s.top+window.scrollY}px`,e.style.width=`${s.width}px`,e.style.height=`${s.height}px`,e.style.display="block",()=>{const e=document.getElementById("magic-iframe-"+t);e&&(e.style.left="-10000px",e.style.top="-10000px",e.style.width="0px",e.style.height="0px",e.style.display="none")}}),[]),(0,o.jsx)("div",{ref:i,style:{width:"100%",height:"1050px"}})}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(6540);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);