"use strict";(self.webpackChunkfused_docs=self.webpackChunkfused_docs||[]).push([[2187],{8822:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>d,toc:()=>h});var s=o(4848),n=o(8453),i=o(8987);o(1023),o(290);const a=o.p+"assets/images/sheets_limit-119a73e85b46f586ba0ce4b267190d56.png",r={title:"Google Sheets",sidebar_label:"Google Sheets",path:"basics/out/googlesheets/googlesheets/",nb_path:"basics/out/googlesheets.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb",description:"Use Google Sheets with Fused!"},l="Google Sheets",d={id:"basics/out/googlesheets/Googlesheets",title:"Google Sheets",description:"Use Google Sheets with Fused!",source:"@site/docs/basics/out/googlesheets/Googlesheets.mdx",sourceDirName:"basics/out/googlesheets",slug:"/basics/out/googlesheets/",permalink:"/fused-docs/basics/out/googlesheets/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Google Sheets",sidebar_label:"Google Sheets",path:"basics/out/googlesheets/googlesheets/",nb_path:"basics/out/googlesheets.ipynb",github:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb",colab:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb",description:"Use Google Sheets with Fused!"},sidebar:"tutorialSidebar",previous:{title:"Geemap",permalink:"/fused-docs/basics/out/geemap/"},next:{title:"HTTP Requests",permalink:"/fused-docs/basics/out/http/"}},c={},h=[{value:"1. Create a UDF in Fused Hosted API",id:"1-create-a-udf-in-fused-hosted-api",level:2},{value:"2. Create a URL for the UDF",id:"2-create-a-url-for-the-udf",level:2},{value:"3. Call the UDF in a cell",id:"3-call-the-udf-in-a-cell",level:2}];function u(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{githubUrl:"https://github.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb",colabUrl:"https://githubtocolab.com/fusedio//fused-docs/blob/main/docs/basics/out/googlesheets.ipynb"}),"\n",(0,s.jsx)(t.h1,{id:"google-sheets",children:"Google Sheets"}),"\n",(0,s.jsxs)(t.p,{children:["The Google Sheets ",(0,s.jsx)(t.a,{href:"https://support.google.com/docs/answer/3093335?hl=en",children:"importData"}),"\ncommand imports data at from a given url in ",(0,s.jsx)(t.code,{children:".csv"})," format. You can use it to load data\nfrom a UDF into a Google Sheets cell."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/gifs/google_sheets.gif",alt:"alt text"})}),"\n",(0,s.jsxs)(t.admonition,{type:"warning",children:[(0,s.jsxs)(t.p,{children:["Google Sheets' ",(0,s.jsx)(t.code,{children:"importData"})," imposes data size constraints that will require the UDF to\nreturn a conservative number of rows. Otherwise it may show the following error message."]}),(0,s.jsx)("div",{style:{textAlign:"center"},children:(0,s.jsx)("img",{src:a,alt:"File",style:{width:600}})})]}),"\n",(0,s.jsx)(t.h2,{id:"1-create-a-udf-in-fused-hosted-api",children:"1. Create a UDF in Fused Hosted API"}),"\n",(0,s.jsx)(t.p,{children:"Create a UDF that returns a table then save it on Workbench to automatically create an\nendpoint."}),"\n",(0,s.jsx)(t.p,{children:"This example retrieves Caltrain live location data from GTFS realtime feed, and returns\nit as a dataframe."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import fused\n\n\n@fused.udf\ndef udf():\n    import pandas as pd\n    import requests\n\n    r = requests.get(f"https://www.caltrain.com/files/rt/vehiclepositions/CT.json")\n    j = r.json()\n    df = pd.json_normalize(j["Entities"])\n    return df\n'})}),"\n",(0,s.jsx)(t.h2,{id:"2-create-a-url-for-the-udf",children:"2. Create a URL for the UDF"}),"\n",(0,s.jsxs)(t.p,{children:["Now,\n",(0,s.jsx)(t.a,{href:"/basics/core-concepts/#generate-endpoints-with-workbench",children:"create a signed Tile HTTP endpoint"}),"\nfor the UDF."]}),"\n",(0,s.jsxs)(t.p,{children:["Append this query parameter to the end of the URL to structure the response as a CSV\ntype: ",(0,s.jsx)(t.code,{children:"?dtype_out_vector=csv"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"The generated URL should look like this:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"https://www.fused.io/server/v1/realtime-shared/940c7d75bb3f12f2c411beeee7293729d35a9429ebb3760df29fa84c3166b7b9/run/file?dtype_out_vector=csv"})}),"\n",(0,s.jsx)(t.h2,{id:"3-call-the-udf-in-a-cell",children:"3. Call the UDF in a cell"}),"\n",(0,s.jsxs)(t.p,{children:["Now that you have the UDF live on Fused Hosted API and a URL to call it, you're ready to\nimport data into Google Sheets. In the cell where you want your data to appear, use the\n",(0,s.jsx)(t.code,{children:"importData"})," function with the URL of your UDF. The syntax is as follows:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:'=importData("https://www.fused.io/server/v1/realtime-shared/940c7d75bb3f12f2c411beeee7293729d35a9429ebb3760df29fa84c3166b7b9/run/file?dtype_out_vector=csv")'})}),"\n",(0,s.jsx)(t.p,{children:"When you enter this formula into a cell, Google Sheets will call your UDF, and the\nreturned dataframe will be automatically populated in the spreadsheet."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python"})})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},1023:(e,t,o)=>{o.d(t,{A:()=>p});o(6540);var s,n=new Uint8Array(16);function i(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(n)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=function(e){return"string"==typeof e&&a.test(e)};for(var l=[],d=0;d<256;++d)l.push((d+256).toString(16).substr(1));const c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!r(o))throw TypeError("Stringified UUID is invalid");return o};const h=function(e,t,o){var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){o=o||0;for(var n=0;n<16;++n)t[o+n]=s[n];return t}return c(s)};var u=o(4848);const p=e=>(0,u.jsxs)("div",{style:{backgroundColor:"var(--ifm-background-surface-color)",marginBottom:"var(--ifm-leading)",borderRadius:"var(--ifm-global-radius)",boxShadow:"var(--ifm-global-shadow-lw)",overflow:"hidden",padding:"10px",font:"var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"},children:[(0,u.jsx)("span",{style:{color:"var(--ifm-color-primary)"},children:"Out: "}),(0,u.jsx)("pre",{style:{margin:"0px",backgroundColor:"inherit"},children:e.children.split("\n").map((e=>(0,u.jsx)("p",{style:{marginBottom:"0px"},children:e},h())))})]})},8987:(e,t,o)=>{o.d(t,{A:()=>i});o(6540);var s=o(8774),n=o(4848);const i=e=>{let{githubUrl:t,colabUrl:o}=e;return(0,n.jsxs)("div",{className:"link-buttons",style:{textAlign:"right"},children:[(0,n.jsx)("br",{}),(0,n.jsx)(s.A,{to:o,children:(0,n.jsx)("img",{src:"https://colab.research.google.com/assets/colab-badge.svg",alt:"Open in Colab"})})," ",(0,n.jsx)(s.A,{to:t,children:(0,n.jsx)("img",{src:"https://badgen.net/static/GitHub/Open/blue?icon=github",alt:"Open in GitHub"})})]})}},290:(e,t,o)=>{o(6540);var s=o(3259),n=o.n(s),i=(o(2303),o(4848));n()({loader:()=>o.e(1236).then(o.bind(o,1236)),loading:e=>{let{timedOut:t}=e;return t?(0,i.jsx)("blockquote",{children:"Error: Loading Plotly timed out."}):(0,i.jsx)("div",{children:"loading..."})},timeout:1e4})},8453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>r});var s=o(6540);const n={},i=s.createContext(n);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);