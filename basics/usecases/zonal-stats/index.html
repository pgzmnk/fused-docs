<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-basics/usecases/zonal-stats" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Zonal Stats | Fused</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" name="twitter:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" property="og:url" content="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Zonal Stats | Fused"><meta data-rh="true" name="description" content="Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings."><meta data-rh="true" property="og:description" content="Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings."><link data-rh="true" rel="icon" href="/fused-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/" hreflang="en"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JNTLW5AVDA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/fused-docs/blog/rss.xml" title="Fused RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fused-docs/blog/atom.xml" title="Fused Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Fused" href="/fused-docs/opensearch.xml"><link rel="stylesheet" href="/fused-docs/assets/css/styles.dfc287fd.css">
<script src="/fused-docs/assets/js/runtime~main.c09bf665.js" defer="defer"></script>
<script src="/fused-docs/assets/js/main.adb4e701.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#991199;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐ If you like Fused, star the UDF <a target="_blank" rel="noopener noreferrer" href="https://github.com/fusedio/udfs/">GitHub</a> repo! ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fused-docs/"><div class="navbar__logo"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Fused</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fused-docs/">Docs</a><a class="navbar__item navbar__link" href="/fused-docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fused-docs/">Basics</a><button aria-label="Collapse sidebar category &#x27;Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/core-concepts/">Core Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/in/">Get data in</a><button aria-label="Expand sidebar category &#x27;Get data in&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/">Transform data</a><button aria-label="Collapse sidebar category &#x27;Transform data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/join/point-with-polygon/">Join operations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/point-with-polygon/">Point with polygon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/raster-with-polygon/">Raster with polygon (Zonal stats)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/raster/band-algebra/">Raster operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/vector/buffer/">Vector operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/h3/h3-to-vector/">H3 operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/advanced/isochrone/">Advanced operations</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/out/">Get data out</a><button aria-label="Expand sidebar category &#x27;Get data out&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/fused-docs/basics/usecases/buffer/">Use cases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/usecases/buffer/">Buffer Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fused-docs/basics/usecases/zonal-stats/">Zonal Stats</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/utilities/">Utilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/faq/">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/python-sdk/">Python SDK</a><button aria-label="Expand sidebar category &#x27;Python SDK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/workbench/">Workbench</a><button aria-label="Expand sidebar category &#x27;Workbench&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fused-docs/contribute/">Contribute to Fused 🍪</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fused-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fused-docs/"><span itemprop="name">Basics</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Use cases</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zonal Stats</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Zonal Statistics</h1>
<p>Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings.</p>
<p>In this tutorial we&#x27;ll focus on zonal statistics between a raster and polygons in a table. We&#x27;ll explore how to perform zonal statistics to approximate the height of buildings using a digital surface model (DSM) raster dataset and a table of building footprint polygons. The raster is the ALOS Global DSM &quot;ALOS World 3D - 30m (AW3D30)&quot; captured by the PRISM optical sensor on the ALOS satellite, with a 30-meter horizontal resolution. The buildings dataset is the &quot;Building Footprints&quot; dataset from Microsoft, which contains the <code>Polygon</code> of buildings in the United States.</p>
<div style="text-align:center"><img src="https://camo.githubusercontent.com/c2f7fcebe282d2834a24b95de0d2dca7cfbced457e7193f921afe2672ae9f771/68747470733a2f2f66757365642d6d616769632e73332e75732d776573742d322e616d617a6f6e6177732e636f6d2f7468756d626e61696c732f756466732d73746167696e672f44534d5f5a6f6e616c5f53746174732e706e67" alt="File" style="width:1200px"></div>
<p><em>Visual representation of building <code>Polygon</code> objects colored based on DSM aggregate values.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem">The problem<a href="#the-problem" class="hash-link" aria-label="Direct link to The problem" title="Direct link to The problem">​</a></h2>
<p>Determining the pixels that within a polygon requires using analysis packages that can operate on both raster and vector data. Once the pixels are identified, we can calculate aggregate statistics such as the mean, sum, or maximum of the pixel values within the polygon.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-solution-zonal-stats">The solution: Zonal Stats<a href="#the-solution-zonal-stats" class="hash-link" aria-label="Direct link to The solution: Zonal Stats" title="Direct link to The solution: Zonal Stats">​</a></h2>
<p>To perform this operation, we can load raster and vector data for spatially overlapping area then perform zonal statistics using methods in <code>xarray</code> and <code>GeoPandas</code> libraries. Here&#x27;s how to do this:</p>
<ol>
<li>Load overlapping the raster and vector data</li>
<li>For the extent of each <code>Polygon</code>, clip the raster to create a mask array</li>
<li>Perform an aggregation operation (e.g., mean, sum, max) on each masked array</li>
<li>Return the results in a <code>GeoDataFrame</code>, where each row corresponds to a <code>Polygon</code> and the a columns contain the value for the aggregate zonal statistics</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">## Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">This example interactively illustrates zonal statistics between a raster </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> a table of polygons</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> the raster array </span><span class="token keyword" style="color:rgb(127, 219, 202)">is</span><span class="token plain"> represented by a grayscale image of the DSM </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> the building footprint are represented </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> purple `Polygon` objects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Users can interact </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> the checkboxes on the sidebar to toggle show</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">hide</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> The raster image</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> The building footprint outlines</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> The building footprints colored by the mean pixel value of the raster</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">You&#x27;ll notice that the building footprints are colored based on the mean pixel value of the raster within the polygon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> The color scale ranges </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> dark </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">low values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> to bright </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">high values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> This visualization helps identify buildings </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> higher </span><span class="token keyword" style="color:rgb(127, 219, 202)">or</span><span class="token plain"> lower height based on the average pixel values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> Iframe </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;@site/src/components/Iframe&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">Iframe url</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA91WW2%2FrNgz%2BK4IL7CRD4kviOHYAY9hWdMAw4ABrz17qwpBtxdGpInkSnTYJ8t8PHSfNpZd1e9iK5YJIJC2K5EfmW1u5Kpg1sfi8UhpItSxYfk%2BoIVVxn8id1IBmdC44NAoDiUzkBfkZZcDInFaJFBR6RMiSxMR37XEQBaMe6Y%2BHdhS5buQ3Dwi6ZNqgwTqRBF%2BJpakBphNr0viyf2v0nVbX6n%2FigIdv5YnVO2guSEGBxok1A6jMxHEM0JLL0p7WhhU2V45hesG0s%2FAcvKMAPmd9M6OaFU6WeeE4D0aF606nhYvvaU5d5nquGwZRlOehW0QRzULqZ5HveVN%2F5I18tBqOo2EQTh1dSwe4YMZZrzbO%2BhG%2Fy80PBSwrlqoa0jaouJLldwfhguWgdFwy9dUoeRIMn9OS%2FeexeL7jhwPfCbxR8HIwmkGtZaqyrxhLTPVpSTJVy8LEt%2F2xb7vuMHKDAQJgCwXceIMQQTAKwx0mQi8aDkfRcLyzCd2R7%2FlDLwzcoeffHZ2rKppzWMaDk%2FKDUpiIKl4nFrBHaBCUWD%2BWJVlQUbMJWecSNom1QdObz5efJ%2BTL5RUxM1WLgrRxkEqrimngzLQHd3t7VLa1eh2VvzD1KxbxOSw%2FBCi9wPGiQRQ6Az8YvFLKd%2BGy4vk9zQSLb3TNjuRTLgQr4isqzLEYJ4S6R%2FmZdckgFVyyNFcCHSXWLcbUI%2FgZjAZ3Jw6fTB94AbPY750Wpi3lfv2pDWfw6XmVLnZ1%2Bn1rcYNZOS3Vxccp1l9NkLM7PzUDpnAvP8dtalb%2FALr%2Fq4n6IUL5t%2FrwTLpvw%2FP2bJqreeLQh4cBaOc4vOF7e9gjz4Su7bkviN9uXfdIdRjVT6IWiy8P7nNPOMUPD2565G9O9E3LVK64wJyTjCICiJIknyHHydRjY4qHPOyKgtzEgG14wTKq7b1RJ7Gu0Ybs2Uqvvew2811kSFMiFZCjYyat%2F5bv2JWqOgeq0905bAv%2BtsP9H9EbDluTlxzuHz51mK7Me3ySBw4zslKSCjSmYN5xCTz69Xtsp1K3KQb6bilmmmPPwW48NePqEoVH0wqZX2pgKRpuhGu847aXl01ztXunoPq%2Bv4hO6ZTkwKlIF5w9pM3dWdwc%2Fgdur5td5xSHyFs51AWLGwJ7plKy3OlkeaZbKTWPvdGZtOKQn6K%2Fe7Ru0xILbqCzS9E2pabT3ZthhrpWz9Lsz5prNmcSjDW5tXAsVFQW1Ox0zECzfEQSRpe4WFIt8KfNKy62lJIrXM0pVEKB4Blunkh8n%2BbMukM7c1ULcZ1rxqQ1mTYjY%2FMNoFCyqxAMAAA%3D&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">## Applications</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">In building </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> urban analysis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> zonal statistics can be used to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Approximate the height of buildings using DSM</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Determine buildings </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> greenery on rooftops using NDVI rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Identify buildings </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> solar panels using solar radiation rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Zonal statistics can be applied to various fields beyond building analysis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Precision Agriculture</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Determine vegetation health within crop polygons using NDVI rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Water Resource Management</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Assess surface water availability </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> watersheds using NDWI rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Environmental Monitoring</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Track forest cover percentage within administrative zones </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> monitor changes over time using LULC rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> Assess building density </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> urban areas using LULC rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">## Scaling up</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Zonal stats can be challenging to implement on large datasets because some tools are specialized to work </span><span class="token keyword" style="color:rgb(127, 219, 202)">with</span><span class="token plain"> either</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> but </span><span class="token keyword" style="color:rgb(127, 219, 202)">not</span><span class="token plain"> both</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> As such</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> handling large datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> such </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> nationwide building footprints </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> high</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain">resolution rasters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> requires strategic approaches to process data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">To perform zonal stats on large datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Fused UDFs can be used to spatially </span><span class="token builtin" style="color:rgb(130, 170, 255)">filter</span><span class="token plain"> the raster </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> table to only perform calculations over subsections of the data that spatially overlap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> This enables the computation to be performed </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> parallel across multiple workers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> making it scalable to </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"> size dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">This example UDF loads the building footprint table `gdf` </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> DSM raster `arr` </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> S3 only </span><span class="token keyword" style="color:rgb(127, 219, 202)">for</span><span class="token plain"> a section defined by `bbox`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> which corresponds to a </span><span class="token builtin" style="color:rgb(130, 170, 255)">map</span><span class="token plain"> tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> It then calculates the zonal statistics</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> returns the results </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> the `GeoDataFrame` `gdf_zonal`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> This process enables Fused workbench to perform the calculation dynamically </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> users scroll </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> zoom </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> the </span><span class="token builtin" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> min_zoom</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;s3://fused-asset/infra/building_msft_us/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> chip_len</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> utils</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">table_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> min_zoom</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    arr </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dsm_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> z_levels</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf_zonal </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">geom_stats</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gdf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> chip_len</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">chip_len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf_zonal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>While zonal statistics is a valuable tool, it&#x27;s often just the starting point for more complex analyses. Combining zonal statistics with other techniques such time series analysis or machine learning approaches can provide even richer insights into your data.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/fused-docs/tags/zonal/">zonal</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/fused-docs/tags/stats/">stats</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/fused-docs/basics/usecases/buffer/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Buffer Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fused-docs/basics/utilities/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Utilities</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-problem" class="table-of-contents__link toc-highlight">The problem</a></li><li><a href="#the-solution-zonal-stats" class="table-of-contents__link toc-highlight">The solution: Zonal Stats</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fused-docs/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/fusedio/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/BxS5wMzdRk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.fused.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Fused, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>