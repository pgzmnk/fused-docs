<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-basics/usecases/zonal-stats" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Zonal Stats | Fused</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" name="twitter:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" property="og:url" content="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Zonal Stats | Fused"><meta data-rh="true" name="description" content="Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings."><meta data-rh="true" property="og:description" content="Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings."><link data-rh="true" rel="icon" href="/fused-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/" hreflang="en"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/usecases/zonal-stats/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JNTLW5AVDA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/fused-docs/blog/rss.xml" title="Fused RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fused-docs/blog/atom.xml" title="Fused Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Fused" href="/fused-docs/opensearch.xml"><link rel="stylesheet" href="/fused-docs/assets/css/styles.dfc287fd.css">
<script src="/fused-docs/assets/js/runtime~main.8fc3b6fa.js" defer="defer"></script>
<script src="/fused-docs/assets/js/main.adb4e701.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#991199;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐ If you like Fused, star the UDF <a target="_blank" rel="noopener noreferrer" href="https://github.com/fusedio/udfs/">GitHub</a> repo! ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fused-docs/"><div class="navbar__logo"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Fused</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fused-docs/">Docs</a><a class="navbar__item navbar__link" href="/fused-docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fused-docs/">Basics</a><button aria-label="Collapse sidebar category &#x27;Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/core-concepts/">Core Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/in/">Get data in</a><button aria-label="Expand sidebar category &#x27;Get data in&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/">Transform data</a><button aria-label="Collapse sidebar category &#x27;Transform data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/join/point-with-polygon/">Join operations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/point-with-polygon/">Point with polygon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/raster-with-polygon/">Raster with polygon (Zonal stats)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/raster/band-algebra/">Raster operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/vector/buffer/">Vector operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/h3/h3-to-vector/">H3 operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/advanced/isochrone/">Advanced operations</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/out/">Get data out</a><button aria-label="Expand sidebar category &#x27;Get data out&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/fused-docs/basics/usecases/buffer/">Use cases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/usecases/buffer/">Buffer Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fused-docs/basics/usecases/zonal-stats/">Zonal Stats</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/utilities/">Utilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/faq/">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/python-sdk/">Python SDK</a><button aria-label="Expand sidebar category &#x27;Python SDK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/workbench/">Workbench</a><button aria-label="Expand sidebar category &#x27;Workbench&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fused-docs/contribute/">Contribute to Fused 🍪</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fused-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fused-docs/"><span itemprop="name">Basics</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Use cases</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zonal Stats</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Zonal Statistics: A Comprehensive Guide</h1>
<p>Zonal statistics is a versatile tool to summarize raster data within defined zones, providing valuable insights across multiple domains. It&#x27;s a geospatial technique that calculates aggregate statistics (e.g., mean, sum, maximum) of the pixel values of a raster (i.e. cell values) that fall within areas defined by another dataset. The method has diverse applications such as determining vegetation health in an agricultural field, assess surface water availability in watersheds, or approximate the height of buildings.</p>
<iframe src="/img/deckgl_vector_zstats.html" height="400px" width="100%" scrolling="no"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="applications">Applications<a href="#applications" class="hash-link" aria-label="Direct link to Applications" title="Direct link to Applications">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="urban-analysis">Urban Analysis<a href="#urban-analysis" class="hash-link" aria-label="Direct link to Urban Analysis" title="Direct link to Urban Analysis">​</a></h3>
<ul>
<li>Approximate the height of buildings using DSM.</li>
<li>Determine buildings with greenery on rooftops using NDVI rasters.</li>
<li>Identify buildings with solar panels using solar radiation rasters.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environmental-management">Environmental Management<a href="#environmental-management" class="hash-link" aria-label="Direct link to Environmental Management" title="Direct link to Environmental Management">​</a></h3>
<ul>
<li>Precision Agriculture: Determine vegetation health within crop polygons using NDVI rasters.</li>
<li>Water Resource Management: Assess surface water availability in watersheds using NDWI rasters.</li>
<li>Environmental Monitoring: Track forest cover percentage within administrative zones and monitor changes over time using LULC rasters.</li>
<li>Assess building density in urban areas using LULC rasters.</li>
</ul>
<div style="text-align:center"><img src="https://camo.githubusercontent.com/c2f7fcebe282d2834a24b95de0d2dca7cfbced457e7193f921afe2672ae9f771/68747470733a2f2f66757365642d6d616769632e73332e75732d776573742d322e616d617a6f6e6177732e636f6d2f7468756d626e61696c732f756466732d73746167696e672f44534d5f5a6f6e616c5f53746174732e706e67" alt="File" style="width:600px"></div>
<p><em>Visual representation of building <code>Polygon</code> objects colored based on DSM aggregate values.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-zonal-statistics">Implementing zonal statistics<a href="#implementing-zonal-statistics" class="hash-link" aria-label="Direct link to Implementing zonal statistics" title="Direct link to Implementing zonal statistics">​</a></h2>
<p>Determining the pixels that within a polygon requires using analysis packages that can operate on both raster and vector data. Once the pixels are identified, we can calculate aggregate statistics such as the mean, sum, or maximum of the pixel values within the polygon.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-steps">Implementation steps<a href="#implementation-steps" class="hash-link" aria-label="Direct link to Implementation steps" title="Direct link to Implementation steps">​</a></h3>
<p>To perform this operation, we can load raster and vector data for spatially overlapping area then perform zonal statistics using methods in <code>xarray</code> and <code>GeoPandas</code> libraries. Here&#x27;s how to do this:</p>
<ol>
<li>Load overlapping the raster and vector data</li>
<li>For the extent of each <code>Polygon</code>, clip the raster to create a mask array</li>
<li>Perform an aggregation operation (e.g., mean, sum, max) on each masked array</li>
<li>Return the results in a <code>GeoDataFrame</code>, where each row corresponds to a <code>Polygon</code> and the a columns contain the value for the aggregate zonal statistics</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-udf">Example UDF<a href="#example-udf" class="hash-link" aria-label="Direct link to Example UDF" title="Direct link to Example UDF">​</a></h3>
<p>This example UDF loads the building footprint table <code>gdf</code> and DSM raster <code>arr</code> from S3 only for a section defined by <code>bbox</code>, which corresponds to a map tile. It then calculates the zonal statistics, and returns the results as the <code>GeoDataFrame</code> <code>gdf_zonal</code>. This process enables Fused workbench to perform the calculation dynamically as users scroll and zoom in the map.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> min_zoom</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;s3://fused-asset/infra/building_msft_us/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> chip_len</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> utils</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">table_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> min_zoom</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    arr </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dsm_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> z_levels</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf_zonal </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">geom_stats</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gdf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> chip_len</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">chip_len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf_zonal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The UDF would return a <code>GeoDataFrame</code> like the following, with an aggregate <code>stats</code> column for each input <code>Polygon</code>:</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">                                                geometry      stats  count</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">660    POLYGON ((-122.39806 37.76221, -122.39806 37.7...  22.000000      5</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">661    POLYGON ((-122.39881 37.76219, -122.39876 37.7...  21.994819    193</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">1452   POLYGON ((-122.39619 37.76326, -122.39613 37.7...  13.500000      2</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">1458   POLYGON ((-122.39774 37.76327, -122.39776 37.7...  11.000000     28</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">3033   POLYGON ((-122.39680 37.76362, -122.39701 37.7...  10.200000      5</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaling-up-with-fused">Scaling up with Fused<a href="#scaling-up-with-fused" class="hash-link" aria-label="Direct link to Scaling up with Fused" title="Direct link to Scaling up with Fused">​</a></h3>
<p>Zonal stats can be challenging to implement on large datasets because some tools are specialized to work with either, but not both. As such, handling large datasets, such as nationwide building footprints and high-resolution rasters, requires strategic approaches to process data.</p>
<p>To perform zonal stats on large datasets, Fused UDFs can be used to spatially filter the raster and table to only perform calculations over subsections of the data that spatially overlap. This enables the computation to be performed in parallel across multiple workers, making it scalable to any size dataset.</p>
<p>// TODO: mention running w/ multiprocess</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>While zonal statistics is a valuable tool, it&#x27;s often just the starting point for more complex analyses. Combining zonal statistics with other techniques such time series analysis or machine learning approaches can provide even richer insights into your data.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-demo-app">⭐ Demo app<a href="#-demo-app" class="hash-link" aria-label="Direct link to ⭐ Demo app" title="Direct link to ⭐ Demo app">​</a></h2>
<!-- -->
<!-- -->
<iframe src="https://staging.fused.io/workbench#app/s/aH4sIAAAAAAAAA91Ye2%2FbNhD%2FKoQCLPZgW5JfsQwIQ7sgRYcWLZp0xVYVLi1RMhuK1EjKsRP4u%2B8oSn7lsWx%2FbMXiBJaO5D1%2Fd7zLnROLhDhTh%2BaFkBoV64TE1wgrVCTXEa%2BpSkuCc0a1WVA64hFXurcgOCGydfq74JihS421Om3XazeSatKKnOrDX3OkF1QhXWohKWy%2BIaeMoVTEpUKCo9uKgwIOVGkaKzQn%2BoYQjjCSWGkiEeYJKgRbZ4IrRM2CxnNGeuhTxYmsCiYkQQtxg7RABZGpkPl9vrCGi0KKFc2xJqAUHCE0W2gkUjQvKUsozxQqFXyBjIRmVBsOpUxxTFAOvmKodX75tt0olmCNFdGVgrVS%2B7zARqELSbneqt9DVyC2Pm6cAm8v3ry7RK%2BYmIMw4I4ip6J8EpIlaHCOumjg5aj14tPgfOC1IwfFuNClJAmarysG7z%2B8hmOiACuNvoQrIY1nt8wV2MsggqSDbqhegK4Dr5sTo8MCYgKeMoZKogQrNRXcarlzSWNnrXDkvGwsvGgsVKBXsy2VIkdvaSyFEqkGmQsaL1BspFBuWXx9bx3y9dD31Cr9kYOuSYUqonoGVRG%2FMhgiK5wX4GQQSCSONV0StkaUsRJQajY%2FE017wWoiM60kN3ukxGtjriQFuIVwbb2NUQYLCtwMOuQ4qziYcyZuhrHe89te%2BDHAc59VFYWilMaWPVfMv5FYA0asxR8VkQqCzbfm2nNGRryATJ2LFVFNoBVNyBxLg3ItsgwYK0gIdwHkacS7B7gzmje0B7QVpWaUE%2FX4FlBLmJzbQjAnoGZBV5AhS8zKrV%2BsRGPNb6I0ycoFRMUkH9aPOEtV3tryB0QljY1PS6m8UyOojqoFcsUL2ahJzDNwWgXRBMtr1GJQNipuqm2cN5dVSWgt4KuhGzYAhiVVJWb0FpscgdrBCkBsAhGl6XoPxFWQzHFQCeQCf5NnttIcmIOXEFXA0J5FTfCr2lnV0xP0M9RfqFc5LiLOMOQTA3eFaOj1zsbBeNRB3bNBLwg8LxiaAwyvDW5CdBdxBD%2BRUwfBmZq63ntj1lt2za6%2FpBqYV%2FTI6exWTqqMDiNnoXWhpq4LaZWBib20BCt6VLiAULDBXfou6Mg0zUlXLSB8iTuf%2B5OzeDxKPC9NEw8%2BaYw94vmeNxkHQRxPvCQI8HyCh%2FNg6PvpcOSPhrBrcBYMxpPUlSV3NWVEuXe3G%2FduBX%2FrzU%2BJXhdkBgCdWaPCgmc%2F7IhLyB8hw4yIb0rwA2Mq0P%2FntvhDdzjpD92xPxo%2FbIwkUNv5zNaCEArRgRVzUfJEhZ%2B7Z8Oe5w0Cb9wHAFRQgBe%2FPwEQjCaTGhMTPxgMRsHgrN4z8UZDfzjwJ2Nv4A%2B%2F7PEVBY6pXof9g%2FBrIcARRXgXOZqstEEQXE5ZZrE6RXcx15vI2cDWq3fn76bo4%2FmFKTslXFzWDgT3LVzImppqYpi2Ow0qbaweR%2BUrIn6BIN6H5XcBSn%2Fs%2BkE%2FmLj94bj%2FSCifhcuCxtfmLgqvZEn26CncaiQJLzBT%2B2S458Q10I92Z0TPTM2eVbUOvPMZbOog%2BO2P%2Bl8OBG633tBEL8Jh5zAwNpTN86k1p396P0ondZw%2BVDuuwCuHoTr5foL1VxXkSOdtMoALG%2Foxbmfq9h9A939VUb8LU%2F6tPDyiNml4nJ4mucyJXR7uCmAvhuKtf%2BwNOuge0ev53gPkp1PX21valeotyWLx4cJ9LGljJrXm0KaD%2FmZF39hO5YIy04dtm5xdlwpzIXSjdVCgN4EpsW5Ye80mGBgvzQjXdCsdq2zleeiEaGp6R7THZmrl236nV4iitWt12rVAG%2FCnBTYX0RMC7ZaHBDaHDwXObtVzZNpWcTeyqGcoAawf16OqSs0Ybsf5WQw5p%2BvyZMrVORD3qhV0fjOl18z0RvAMOla5vDbJZd9d0yd3l8FhOwUjGgzzsyUlNzOjOwkN81%2FhtRrbWoc4hL6V6jIhoWlgj5YEz%2Bo1nh2t3QqRh%2F7oiFpQHR%2Biv733bN0SMpj%2FWrWLbGvdajfbwENtp%2BNI8kdJJcmhg1fO9LMDZaGAIQ6reo0obR5X1TQID2ssGXxZv8JD1VJSAU851gUTMDXN4WX7D5MujonzBfapi5Kxy1jCHOpMU1MyNn8Ck4LFonwRAAA%3D" height="1050px" width="100%" scrolling="no"></iframe></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/fused-docs/tags/zonal/">zonal</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/fused-docs/tags/stats/">stats</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/fused-docs/basics/usecases/buffer/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Buffer Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fused-docs/basics/utilities/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Utilities</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#applications" class="table-of-contents__link toc-highlight">Applications</a><ul><li><a href="#urban-analysis" class="table-of-contents__link toc-highlight">Urban Analysis</a></li><li><a href="#environmental-management" class="table-of-contents__link toc-highlight">Environmental Management</a></li></ul></li><li><a href="#implementing-zonal-statistics" class="table-of-contents__link toc-highlight">Implementing zonal statistics</a><ul><li><a href="#implementation-steps" class="table-of-contents__link toc-highlight">Implementation steps</a></li><li><a href="#example-udf" class="table-of-contents__link toc-highlight">Example UDF</a></li><li><a href="#scaling-up-with-fused" class="table-of-contents__link toc-highlight">Scaling up with Fused</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#-demo-app" class="table-of-contents__link toc-highlight">⭐ Demo app</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fused-docs/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/fusedio/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/BxS5wMzdRk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.fused.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Fused, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>