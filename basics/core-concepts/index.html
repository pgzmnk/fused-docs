<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-basics/core-concepts" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Core Concepts | Fused</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" name="twitter:image" content="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png"><meta data-rh="true" property="og:url" content="https://fusedio.github.io/fused-docs/basics/core-concepts/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Core Concepts | Fused"><meta data-rh="true" name="description" content="Fused lets teams run Python in the cloud without having to think about infrastructure. It&#x27;s the glue layer between your most important data and the applications that consume the data."><meta data-rh="true" property="og:description" content="Fused lets teams run Python in the cloud without having to think about infrastructure. It&#x27;s the glue layer between your most important data and the applications that consume the data."><link data-rh="true" rel="icon" href="/fused-docs/img/favicon.png"><link data-rh="true" rel="canonical" href="https://fusedio.github.io/fused-docs/basics/core-concepts/"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/core-concepts/" hreflang="en"><link data-rh="true" rel="alternate" href="https://fusedio.github.io/fused-docs/basics/core-concepts/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JNTLW5AVDA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/fused-docs/blog/rss.xml" title="Fused RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fused-docs/blog/atom.xml" title="Fused Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Fused" href="/fused-docs/opensearch.xml"><link rel="stylesheet" href="/fused-docs/assets/css/styles.dfc287fd.css">
<script src="/fused-docs/assets/js/runtime~main.67cde9ef.js" defer="defer"></script>
<script src="/fused-docs/assets/js/main.fd674a8e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#991199;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">⭐ If you like Fused, star the UDF <a target="_blank" rel="noopener noreferrer" href="https://github.com/fusedio/udfs/">GitHub</a> repo! ⭐</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fused-docs/"><div class="navbar__logo"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/fused-docs/img/logo-black-bg-transparent.svg" alt="Fused Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Fused</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fused-docs/">Docs</a><a class="navbar__item navbar__link" href="/fused-docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fused-docs/">Basics</a><button aria-label="Collapse sidebar category &#x27;Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/quickstart/">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fused-docs/basics/core-concepts/">Core Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/in/">Get data in</a><button aria-label="Expand sidebar category &#x27;Get data in&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/">Transform data</a><button aria-label="Collapse sidebar category &#x27;Transform data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/fused-docs/basics/transform/join/point-with-line/">Join operations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/point-with-line/">🛠️ Point with line</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/point-with-polygon/">🛠️ Point with polygon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/polygon-with-polygon/">🛠️ Polygon with polygon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/raster-with-point/">🛠️ Raster with point</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/transform/join/raster-with-polygon/">Raster with polygon (Zonal stats)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/raster/band-algebra/">Raster operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/vector/buffer/">Vector operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/h3/h3-to-raster/">H3 operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/transform/advanced/isochrone/">Advanced operations</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/out/">Get data out</a><button aria-label="Expand sidebar category &#x27;Get data out&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/fused-docs/basics/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/fused-docs/basics/usecases/fcc-broadband/">Use cases</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/utilities/">Utilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fused-docs/basics/faq/">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/python-sdk/">Python SDK</a><button aria-label="Expand sidebar category &#x27;Python SDK&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fused-docs/workbench/">Workbench</a><button aria-label="Expand sidebar category &#x27;Workbench&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fused-docs/contribute/">Contribute to Fused 🍪</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fused-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fused-docs/"><span itemprop="name">Basics</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Core Concepts</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Core concepts</h1>
<p>Fused lets teams run Python in the cloud without having to think about infrastructure. It&#x27;s the glue layer between your most important data and the applications that consume the data.</p>
<p>If you&#x27;re looking to simplify your life with serverless cloud, these pages will help you understand the patterns and best practices to work with Fused.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-it-work">How does it work?<a href="#how-does-it-work" class="hash-link" aria-label="Direct link to How does it work?" title="Direct link to How does it work?">​</a></h2>
<p>Fused takes your Python code and runs it in the cloud. Fused lets any of your tools run your code and load its output so you can easily move data across your different apps. This enables you to dramatically simplify your architecture and easily create integrations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-udf">The UDF<a href="#the-udf" class="hash-link" aria-label="Direct link to The UDF" title="Direct link to The UDF">​</a></h2>
<p>User Defined Functions (UDFs) are the core building blocks of Fused. They contain the Python code you want to run. As this diagram shows, the UDF code defines interactions with datasets and data platforms using standard Python libraries. Fused automagically creates a Hosted API endpoint for each of your UDFs. When an app calls the endpoint, Fused runs the UDF code on a serverless machine and returns the function output.</p>
<p>As a glue layer, UDFs integrate with your most important apps and can call each other (sequentially and in parallel) to assemble into complex workflows.</p>
<p><img decoding="async" loading="lazy" src="https://fused-magic.s3.us-west-2.amazonaws.com/docs_assets/ecosystem_diagram.png" alt="alt text" class="img_ev3q"></p>
<p>You can create and run UDFs on the Fused <a href="/fused-docs/workbench/">Workbench</a> browser IDE or in any Python environment using the <a href="/fused-docs/python-sdk/">Fused Python SDK</a>. When you save a UDF in Fused, you automatically get an endpoint for it which can be called by any tool that can make an HTTP request.</p>
<p>To write a UDF, its important to understand its anatomy. A UDF is a Python function with the following components, which the following sections describe at depth.</p>
<ul>
<li><a href="/fused-docs/basics/core-concepts/#a-fusedudf-decorator">a) <code>@fused.udf</code> decorator</a></li>
<li><a href="/fused-docs/basics/core-concepts/#b-function-declaration">b) Function declaration</a></li>
<li><a href="/fused-docs/basics/core-concepts/#c-udf-parameters">c) UDF parameters</a></li>
<li><a href="/fused-docs/basics/core-concepts/#d-return-object">d) Return object</a></li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># a) Fused decorator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># b) Function declaration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># c) UDF parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> utils </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> table_to_tile</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># d) Return object</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-fusedudf-decorator">a) <code>@fused.udf</code> decorator<a href="#a-fusedudf-decorator" class="hash-link" aria-label="Direct link to a-fusedudf-decorator" title="Direct link to a-fusedudf-decorator">​</a></h3>
<p>To create a UDF, decorate a Python function with <code>@fused.udf</code>. This decorator supercharges the function with the ability to run its code in a serverless cloud environment that automatically provisions and scales compute resources.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># a) Fused decorator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-function-declaration">b) Function declaration<a href="#b-function-declaration" class="hash-link" aria-label="Direct link to b) Function declaration" title="Direct link to b) Function declaration">​</a></h3>
<p>The next step is to structure the function&#x27;s business logic to interact with upstream data sources and return an object which will be the UDF&#x27;s output.</p>
<p>To illustrate, this UDF is a function called <code>udf</code> that returns a dataframe. Notice how import statements must be placed within the function declaration so they go wherever the function goes.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># b) Function declaration</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> utils </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> table_to_tile</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    gdf</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-udf-parameters">c) UDF parameters<a href="#c-udf-parameters" class="hash-link" aria-label="Direct link to c) UDF parameters" title="Direct link to c) UDF parameters">​</a></h3>
<p>When you call a UDF, you can choose to pass data to its parameters. This enables UDFs to dynamically run code based on its input parameters.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explicit-typing">Explicit Typing<a href="#explicit-typing" class="hash-link" aria-label="Direct link to Explicit Typing" title="Direct link to Explicit Typing">​</a></h4>
<p>Fused resolves arguments to their specified types.</p>
<p>This is helpful when UDF endpoints are called via HTTP requests that specify argument values via <a href="https://www.branch.io/glossary/query-parameters/" target="_blank" rel="noopener noreferrer">query parameters</a>, which require input parameters to be serializable.</p>
<p>For example, take a function like this one, with typed parameters.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># c) UDF parameters</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> utils </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> table_to_tile</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    gdf</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_to_tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> table</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">table_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>bbox</code> argument gives the UDF spatial awareness and users can decide its structure, for convenience - which you can read more about <a href="/fused-docs/basics/core-concepts/#the-bbox-object">here</a>.</p>
<p>When its endpoint is called like so, Fused injects a <code>bbox</code> parameter corresponding to a Tile with the <code>1,1,1</code> index, resolve <code>table_path</code> value as a string and the <code>n</code> value as an integer.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(214, 222, 235)">-XGET</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://app.fused.io/server/v1/realtime-shared/</span><span class="token string variable" style="color:rgb(214, 222, 235)">$SHARED_TOKEN</span><span class="token string" style="color:rgb(173, 219, 103)">/run/tiles/1/1/1?table_path=table.shp&amp;n=4&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-return-object">d) Return object<a href="#d-return-object" class="hash-link" aria-label="Direct link to d) Return object" title="Direct link to d) Return object">​</a></h3>
<p>Like with a regular Python function, the UDF return statement makes a UDF function exit and hand back the return object to its caller.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> gdf </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># d) Return object</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When writing a UDF, the data type and CRS of its returned object determines how it’ll appear on the map. To work with standard file and map services, Fused expects UDFs to return data in either raster or tabular vector formats.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="vector">Vector<a href="#vector" class="hash-link" aria-label="Direct link to Vector" title="Direct link to Vector">​</a></h4>
<p>Vectors represent real-world features with points, lines, and polygons. Fused accepts the following Vector return types:</p>
<ul>
<li><code>gpd.GeoDataFrame</code></li>
<li><code>pd.DataFrame</code></li>
<li><code>gpd.GeoSeries</code></li>
<li><code>pd.Series</code></li>
<li><code>shapely geometry</code></li>
</ul>
<p>Fused expects all spatial data in <code>EPSG:4326</code> - <code>WGS84</code> coordinates, using Latitude-Longitude units in decimal degrees. If the CRS of the returned object is not in <code>EPSG:4326</code> CRS, Fused will make a best effort to convert it - so it&#x27;s preferable that UDFs are written to return a data in the <code>EPSG:4326</code> CRS.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="raster">Raster<a href="#raster" class="hash-link" aria-label="Direct link to Raster" title="Direct link to Raster">​</a></h4>
<p>Raster data is comprised of pixels with values, typically arranged in a grid. Rasters can have one or multiple layers.</p>
<p>Fused accepts the following Raster return types</p>
<ul>
<li><code>numpy.ndarray</code></li>
<li><code>xarray.DataArray</code></li>
<li><code>datashader.transfer_functions.Image</code></li>
<li><code>io.BytesIO</code> (including png images)</li>
</ul>
<p>The returned raster object must have a geospatial component. This tells Fused where on the map to render it as an image. For example, this UDF returns an <code>xarray</code> <code>DataArray</code>, which inherently contains coordinates that tell Fused where on the map to place it. Verify this by printing the object and its type.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> fused</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lat</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lng</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dataset</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;general&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> version</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;1.5.4&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> rioxarray</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    lat2</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lat</span><span class="token operator" style="color:rgb(127, 219, 202)">//</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    lng2 </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lng</span><span class="token operator" style="color:rgb(127, 219, 202)">//</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    cog_url </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">f&quot;s3://dataforgood-fb-data/hrsl-cogs/hrsl_</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">dataset</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">/v1.5/cog_globallat_</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">lat2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">_lon_</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">lng2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">_</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">dataset</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">-v</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">version</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(173, 219, 103)">.tif&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    rds </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> rioxarray</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">open_rasterio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        cog_url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        masked</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        overview_level</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Show the output type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Inspect the output object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> rds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The print statements above should display the following in the stdout box, which shows how the layer value and coordinates of the <code>DataArray</code> object.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;class &#x27;xarray.core.dataarray.DataArray&#x27;&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;xarray.DataArray (band: 1, y: 1126, x: 1126)&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">[1267876 values with dtype=float64]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Coordinates:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  * band         (band) int64 1</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  * x            (x) float64 30.0 30.01 30.02 30.03 ... 39.97 39.98 39.99 40.0</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  * y            (y) float64 -0.0001389 -0.009028 -0.01792 ... -9.991 -10.0</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    spatial_ref  int64 0</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Attributes:</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    AREA_OR_POINT:  Area</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    scale_factor:   1.0</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    add_offset:     0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>💡 There&#x27;s 2 ways to control the transparency of raster images.</p>
</blockquote>
<ol>
<li>In RGB images, the color black (0,0,0) is automatically set to full transparency.</li>
<li>If a 4 channel array is passed, i.e. RGBA, the value of the 4th channel is the transparency.</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>When returning a raster object that doesn’t have spatial metadata, like a numpy array, the UDF must return the object&#x27;s <em>bounds</em> to tell Fused where to place it on the map. For example:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">…</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">…</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> bbox</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you forget to pass the bounds, Fused will default its bounds to <code>(-180, -90, 180, 90)</code> and the output image will expand to the size of the globe.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution-modes">Execution modes<a href="#execution-modes" class="hash-link" aria-label="Direct link to Execution modes" title="Direct link to Execution modes">​</a></h2>
<p>Fused automatically creates an endpoint for all saved Fused UDFs. When a client application calls a UDF endpoint, Fused runs a lightweight serverless Python operation and returns the function output. A call to a Fused UDF endpoint can return data as if it were a single remote <code>File</code>. The same endpoint can be called dynamically, as <code>Tile</code>, so it interoperates with map tiling systems.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="file--tile">File &amp; Tile<a href="#file--tile" class="hash-link" aria-label="Direct link to File &amp; Tile" title="Direct link to File &amp; Tile">​</a></h4>
<p>To understand how a Fused UDF can be configured to execute, it&#x27;s important to first understand the difference between <code>File</code> and <code>Tile</code> data.</p>
<p>Consider this diagram. When loaded as a remote File, every coordinate of the complex polygon would be included in one single file. In a Tiled format, there are predefined tile sets (grids) and the geometry is split into one or more Files, where each File represents one cell of the grid.</p>
<!-- -->
<div style="text-align:center"><img src="/fused-docs/assets/images/filetile6-077f637a544bf28c01260eb7c6a7681e.png" alt="File" style="width:400px"></div>
<p>Loading or rendering an entire dataset is an expensive operation in part because of the data volume that must transfer across the network. Fused UDFs can be designed to automatically split and output a dataset across several <code>Tiles</code> - and speed up computation by operating on each part of the dataset in parallel.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="file">File<a href="#file" class="hash-link" aria-label="Direct link to File" title="Direct link to File">​</a></h5>
<p>When an endpoint is called as a <code>File</code>, the UDF runs only once and returns all output data in a single batch. This behaves like the access pattern for a remote file URL.</p>
<!-- -->
<div style="text-align:center"><img src="/fused-docs/assets/images/image-file2-e3c12184c845c2cf020effb0d2c3ced6.png" alt="File" style="width:600px"></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="tile">Tile<a href="#tile" class="hash-link" aria-label="Direct link to Tile" title="Direct link to Tile">​</a></h5>
<p>When and endpoint is called as a <code>Tile</code>, the endpoint becomes interoperable with map tiling clients. The endpoint is called as a <code>File</code> for every <code>Tile</code> requested, and Fused dynamically passes a <code>bbox</code> object to each UDF call corresponding to the index of each tile on the map.</p>
<!-- -->
<!-- -->
<div style="text-align:center"><img src="/fused-docs/assets/images/image-tile2-d7330274eb7dab32487d46d1d6d85363.png" alt="File" style="width:600px"></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-bbox-object">The <code>bbox</code> object<a href="#the-bbox-object" class="hash-link" aria-label="Direct link to the-bbox-object" title="Direct link to the-bbox-object">​</a></h4>
<p>A UDF can strategically leverage <a href="https://guide.cloudnativegeo.org/" target="_blank" rel="noopener noreferrer">cloud-optimized data formats</a> and effeciently load only a fraction of a dataset. A UDF becomes spatially aware when it leverages the <code>bbox</code> parameter to spatially filter the datasets it operates on. This way, Fused distributes execution across multiple workers that scale and wind down as needed. Tile-level spatial filtering supercharges UDFs to process only specific parts of a dataset - based on specified geographic or logical partitions.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The growing popularity of cloud optimized data formats is revolutionizing data processing by eliminating the need for specialized hardware to handle large datasets. For further reading on data formats, refer to resources on: <a href="https://www.cogeo.org/" target="_blank" rel="noopener noreferrer">Cloud Optimized GeoTiff</a>, <a href="https://geoparquet.org/" target="_blank" rel="noopener noreferrer">Geoparquet</a>, and <a href="https://geoarrow.org/format.html" target="_blank" rel="noopener noreferrer">GeoArrow</a>.</p></div></div>
<p>Tile mapping tools call Fused endpoints and dynamically pass an XYZ index for each Tile to render. When a UDF endpoint is called this way - in Tile mode - Fused passes the UDF a <code>bbox</code> object as the first parameter. This object is a data structure with information that corresponds to the Tile&#x27;s bounds and/or XYZ coordinates. The object is named <code>bbox</code> by convention, but it&#x27;s possible to use a different name as long as it&#x27;s in the first parameter.</p>
<p>For convenience, users can decide the structure of the <code>bbox</code> object by setting explicit typing. The 3 available structures are:</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="fusedtypestilegdf"><code>fused.types.TileGDF</code><a href="#fusedtypestilegdf" class="hash-link" aria-label="Direct link to fusedtypestilegdf" title="Direct link to fusedtypestilegdf">​</a></h5>
<p>This is a <a href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html" target="_blank" rel="noopener noreferrer">geopandas.geodataframe.GeoDataFrame</a> with <code>x</code>, <code>y</code>, <code>z</code>, and <code>geometry</code> columns.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TileGDF</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> bbox</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">      x    y   z                                           geometry</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">327</span><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">790</span><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token plain">  POLYGON </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="fusedtypesbbox"><code>fused.types.Bbox</code><a href="#fusedtypesbbox" class="hash-link" aria-label="Direct link to fusedtypesbbox" title="Direct link to fusedtypesbbox">​</a></h5>
<p>This is a <a href="https://shapely.readthedocs.io/en/stable/reference/shapely.Polygon.html" target="_blank" rel="noopener noreferrer">shapely.geometry.polygon.Polygon</a> corresponding to the Tile&#x27;s bounds.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> bbox</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> POLYGON </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">122.0</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">37.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="fusedtypestilexyz"><code>fused.types.TileXYZ</code><a href="#fusedtypestilexyz" class="hash-link" aria-label="Direct link to fusedtypestilexyz" title="Direct link to fusedtypestilexyz">​</a></h5>
<p>This is a <a href="https://mercantile.readthedocs.io/en/stable/api/mercantile.html" target="_blank" rel="noopener noreferrer">mercantile.Tile</a> object with values for the <code>x</code>, <code>y</code>, and <code>z</code> Tile indices.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TileXYZ</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> bbox</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> Tile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">328</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">790</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> z</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If the UDF is called as a File, Fused does not pass a <code>bbox</code> parameter. To write UDFs so they can be called in either execution mode, Fused recommends setting the <code>bbox</code> as the first parameter, and typing it as a <code>fused.types.Bbox</code> with a default value of <code>None</code>. This will enable the UDF to run in both as <code>File</code> (when <code>bbox</code> isn’t necessarily passed) and as a <code>Tile</code>. For example:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bbox</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using the Fused Workbench, a UDF can be configured to render as &quot;Auto&quot; so Workbench automatically handles the output as <code>Tile</code> if it statically checks that the above types are used in the UDF. Otherwise, it assumes File.</p><p>UDFs called via the Fused Python SDK or HTTP requests run as Tile only if a parameter specifies the <code>Tile</code> geometry.</p></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="examples-of-using-the-bbox-object">Examples of using the bbox object<a href="#examples-of-using-the-bbox-object" class="hash-link" aria-label="Direct link to Examples of using the bbox object" title="Direct link to Examples of using the bbox object">​</a></h5>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="a-spatially-filter-raster-files">a) Spatially filter raster files<a href="#a-spatially-filter-raster-files" class="hash-link" aria-label="Direct link to a) Spatially filter raster files" title="Direct link to a) Spatially filter raster files">​</a></h6>
<p>The Fused utility function <code>utils.mosaic_tiff</code> and <code>pystac-client</code>&#x27;s <code>catalog.search</code> illustrate how to use <code>bbox</code> to spatially filter a dataset.</p>
<p>For example, function <code>utils.mosaic_tiff</code> generates a mosaic image from a list of TIFF files. <code>bbox</code> defines the area of interest within the list of TIFF files set by <code>tiff_list</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TileGDF</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    utils </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://github.com/fusedio/udfs/tree/f928ee1/public/common/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">utils</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    data </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> utils</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mosaic_tiff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        bbox</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        tiff_list</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">tiff_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        output_shape</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As an example, the <a href="https://github.com/fusedio/udfs/blob/b89a3aab05cb75dab25abb73e4c17490844ab764/public/LULC_Tile_Example/LULC_Tile_Example.py#L21-L27" target="_blank" rel="noopener noreferrer">LULC_Tile UDF</a> uses <code>mosaic_tiff</code> to create a mosaic from a set of Land Cover tiffs.</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id="spatially-filter-stac-datasets">Spatially filter STAC datasets<a href="#spatially-filter-stac-datasets" class="hash-link" aria-label="Direct link to Spatially filter STAC datasets" title="Direct link to Spatially filter STAC datasets">​</a></h6>
<p>STAC (<a href="https://github.com/radiantearth/stac-spec" target="_blank" rel="noopener noreferrer">SpatioTemporal Asset Catalog</a>) datasets can be queried by passing the bounding box’s bounds (<code>bbox.bounds</code>) to the pystac client of the Python <a href="https://pypi.org/project/pystac-client/" target="_blank" rel="noopener noreferrer">pystac-client</a> library.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@fused</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">udf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">udf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fused</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TileGDF</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> pystac_client</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> pystac</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">extensions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">eo </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> EOExtension </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> eo</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    catalog </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> pystac_client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">open</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        modifier</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">planetary_computer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sign_inplace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    items </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> catalog</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">search</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        collections</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">collection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        bbox</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">bbox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">total_bounds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">item_collection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="call-a-udf-endpoint">Call a UDF endpoint<a href="#call-a-udf-endpoint" class="hash-link" aria-label="Direct link to Call a UDF endpoint" title="Direct link to Call a UDF endpoint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="file-1">File<a href="#file-1" class="hash-link" aria-label="Direct link to File" title="Direct link to File">​</a></h4>
<p>By default, a UDF runs as <code>File</code> - it executes once and returns a single output that corresponds to the input parameters. The UDF endpoint behaves like a remote file in that calling it returns a single batch of data - but the endpoint also accepts parameters that dynamically influence the UDF&#x27;s execution.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">https://www.fused.io/server/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">./run/file?dtype_out_vector</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">csv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This enables client applications to make an HTTP request and load the UDF&#x27;s output data into the tool that makes the call.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Note that files are downloaded entirely - even if the data is requested as a Parquet.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tile-1">Tile<a href="#tile-1" class="hash-link" aria-label="Direct link to Tile" title="Direct link to Tile">​</a></h4>
<p>The same UDF&#x27;s API endpoint can be called to run like a <code>Tile</code>. This makes it possible for Fused to serve vector or raster tiles into industry standard tools that work with <a href="https://en.wikipedia.org/wiki/Tiled_web_map" target="_blank" rel="noopener noreferrer">tiled web maps</a> - think Leaflet, Mapbox, Foursquare Studio, Lonboard, and beyond.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">https://www.fused.io/server/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">./run/tiles/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">?</span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;</span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">dtype_out_vector</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">csv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Tiling clients can make dozens of simultaneous calls to the Fused API endpoint - one for each tile - and seamlessly stitch the outputs to render a map. Instead of operating on an entire dataset, Fused only acts on the data that corresponds to the area visible in the current viewport.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>You can read more about the XYZ indexing system in the <a href="http://Deck.gl" target="_blank" rel="noopener noreferrer">Deck.gl</a> <a href="https://deck.gl/docs/api-reference/geo-layers/tile-layer#indexing-system" target="_blank" rel="noopener noreferrer">documentation</a>. In fact, Fused Workbench runs UDFs on a serverless backend and renders output in Deck.gl.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/fused-docs/tags/core-concepts/">Core Concepts</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/fused-docs/basics/quickstart/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fused-docs/basics/in/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Get data in</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How does it work?</a></li><li><a href="#the-udf" class="table-of-contents__link toc-highlight">The UDF</a><ul><li><a href="#a-fusedudf-decorator" class="table-of-contents__link toc-highlight">a) <code>@fused.udf</code> decorator</a></li><li><a href="#b-function-declaration" class="table-of-contents__link toc-highlight">b) Function declaration</a></li><li><a href="#c-udf-parameters" class="table-of-contents__link toc-highlight">c) UDF parameters</a><ul><li><a href="#explicit-typing" class="table-of-contents__link toc-highlight">Explicit Typing</a></li></ul></li><li><a href="#d-return-object" class="table-of-contents__link toc-highlight">d) Return object</a><ul><li><a href="#vector" class="table-of-contents__link toc-highlight">Vector</a></li><li><a href="#raster" class="table-of-contents__link toc-highlight">Raster</a></li></ul></li></ul></li><li><a href="#execution-modes" class="table-of-contents__link toc-highlight">Execution modes</a><ul><li><a href="#file--tile" class="table-of-contents__link toc-highlight">File &amp; Tile</a></li><li><a href="#the-bbox-object" class="table-of-contents__link toc-highlight">The <code>bbox</code> object</a></li><li><a href="#call-a-udf-endpoint" class="table-of-contents__link toc-highlight">Call a UDF endpoint</a><ul><li><a href="#file-1" class="table-of-contents__link toc-highlight">File</a></li><li><a href="#tile-1" class="table-of-contents__link toc-highlight">Tile</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fused-docs/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/fusedio/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/BxS5wMzdRk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.fused.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/fusedio/udfs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Fused, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>